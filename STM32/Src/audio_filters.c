#include "audio_filters.h"
#include "stm32h7xx_hal.h"
#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <math.h>
#include "arm_math.h"
#include "functions.h"
#include "wm8731.h"
#include "settings.h"
#include "noise_reduction.h"
#include "noise_blanker.h"
#include "auto_notch.h"
#include "trx_manager.h"
#include "vad.h"

//Private variables
static float32_t Fir_RX1_Hilbert_State_I[FIR_RX1_HILBERT_STATE_SIZE] = {0}; // buffers of filter states
static float32_t Fir_RX1_Hilbert_State_Q[FIR_RX1_HILBERT_STATE_SIZE] = {0};
static float32_t Fir_RX2_Hilbert_State_I[FIR_RX2_HILBERT_STATE_SIZE] = {0};
static float32_t Fir_RX2_Hilbert_State_Q[FIR_RX2_HILBERT_STATE_SIZE] = {0};
static float32_t Fir_Tx_Hilbert_State_I[FIR_TX_HILBERT_STATE_SIZE] = {0};
static float32_t Fir_Tx_Hilbert_State_Q[FIR_TX_HILBERT_STATE_SIZE] = {0};
static float32_t IIR_RX1_LPF_I_State[IIR_RX1_LPF_Taps_STATE_SIZE] = {0};
static float32_t IIR_RX1_LPF_Q_State[IIR_RX1_LPF_Taps_STATE_SIZE] = {0};
static float32_t IIR_RX1_GAUSS_State[IIR_RX1_GAUSS_Taps_STATE_SIZE] = {0};
static float32_t IIR_RX2_LPF_I_State[IIR_RX2_LPF_Taps_STATE_SIZE] = {0};
static float32_t IIR_RX2_LPF_Q_State[IIR_RX2_LPF_Taps_STATE_SIZE] = {0};
static float32_t IIR_RX2_GAUSS_State[IIR_RX2_GAUSS_Taps_STATE_SIZE] = {0};
static float32_t IIR_TX_LPF_I_State[IIR_RX2_LPF_Taps_STATE_SIZE] = {0};
static float32_t IIR_RX1_HPF_I_State[IIR_RX1_HPF_Taps_STATE_SIZE] = {0};
static float32_t IIR_RX2_HPF_I_State[IIR_RX2_HPF_Taps_STATE_SIZE] = {0};
static float32_t IIR_TX_HPF_I_State[IIR_RX2_HPF_Taps_STATE_SIZE] = {0};
static float32_t IIR_RX1_HPF_SQL_State[IIR_RX1_HPF_SQL_STATE_SIZE] = {0};
static float32_t IIR_RX2_HPF_SQL_State[IIR_RX2_HPF_SQL_STATE_SIZE] = {0};
static float32_t NOTCH_RX1_Coeffs[BIQUAD_COEFF_IN_STAGE * NOTCH_STAGES] = {0};
static float32_t NOTCH_RX2_Coeffs[BIQUAD_COEFF_IN_STAGE * NOTCH_STAGES] = {0};
static float32_t NOTCH_RX1_State[2 * NOTCH_STAGES] = {0};
static float32_t NOTCH_RX2_State[2 * NOTCH_STAGES] = {0};
static float32_t NOTCH_FFT_I_State[2 * NOTCH_STAGES] = {0};
static float32_t NOTCH_FFT_Q_State[2 * NOTCH_STAGES] = {0};
static float32_t EQ_RX_LOW_FILTER_State[2 * EQ_STAGES] = {0};
static float32_t EQ_RX_MID_FILTER_State[2 * EQ_STAGES] = {0};
static float32_t EQ_RX_HIG_FILTER_State[2 * EQ_STAGES] = {0};
static float32_t EQ_RX_LOW_FILTER_Coeffs[BIQUAD_COEFF_IN_STAGE * EQ_STAGES] = {0};
static float32_t EQ_RX_MID_FILTER_Coeffs[BIQUAD_COEFF_IN_STAGE * EQ_STAGES] = {0};
static float32_t EQ_RX_HIG_FILTER_Coeffs[BIQUAD_COEFF_IN_STAGE * EQ_STAGES] = {0};
static float32_t EQ_MIC_LOW_FILTER_State[2 * EQ_STAGES] = {0};
static float32_t EQ_MIC_MID_FILTER_State[2 * EQ_STAGES] = {0};
static float32_t EQ_MIC_HIG_FILTER_State[2 * EQ_STAGES] = {0};
static float32_t EQ_MIC_LOW_FILTER_Coeffs[BIQUAD_COEFF_IN_STAGE * EQ_STAGES] = {0};
static float32_t EQ_MIC_MID_FILTER_Coeffs[BIQUAD_COEFF_IN_STAGE * EQ_STAGES] = {0};
static float32_t EQ_MIC_HIG_FILTER_Coeffs[BIQUAD_COEFF_IN_STAGE * EQ_STAGES] = {0};
static float32_t AGC_RX1_KW_HSHELF_FILTER_State[2 * EQ_STAGES] = {0};
static float32_t AGC_RX2_KW_HSHELF_FILTER_State[2 * EQ_STAGES] = {0};
static float32_t AGC_RX1_KW_HPASS_FILTER_State[2 * EQ_STAGES] = {0};
static float32_t AGC_RX2_KW_HPASS_FILTER_State[2 * EQ_STAGES] = {0};
static float32_t AGC_RX_KW_HSHELF_FILTER_Coeffs[BIQUAD_COEFF_IN_STAGE * EQ_STAGES] = {0};
static float32_t AGC_RX_KW_HPASS_FILTER_Coeffs[BIQUAD_COEFF_IN_STAGE * EQ_STAGES] = {0};

static DC_filter_state_type DC_Filter_State[8] = {0}; // states of the DC corrector

// Collection of filters
//IQ Hilbert with (-0 q / +90 i) degrees phase added,  48000 sampling frequency Kaiser, Kaiser Beta 4.800 (+90), Raised Cosine 0.930 (-0) // Iowa Hills Hilbert Filters
static const float32_t FIR_HILB_I_coeffs[IQ_HILBERT_TAPS] = {0.000000000000000000, 0.000348718040684899, 0.000000000000000000, 0.000430833440231578, 0.000000000000000000, 0.000522908939129710, 0.000000000000000000, 0.000625643170080525, 0.000000000000000000, 0.000739763696285730, 0.000000000000000000, 0.000866029072658519, 0.000000000000000000, 0.001005231378692548, 0.000000000000000000, 0.001158199311056187, 0.000000000000000000, 0.001325801939712967, 0.000000000000000000, 0.001508953250504772, 0.000000000000000000, 0.001708617620559288, 0.000000000000000000, 0.001925816401721571, 0.000000000000000000, 0.002161635822912572, 0.000000000000000000, 0.002417236466741860, 0.000000000000000000, 0.002693864631427011, 0.000000000000000000, 0.002992865959230020, 0.000000000000000000, 0.003315701801645692, 0.000000000000000000, 0.003663968905292113, 0.000000000000000000, 0.004039423148679463, 0.000000000000000000, 0.004444008249195281, 0.000000000000000000, 0.004879890607273629, 0.000000000000000000, 0.005349501779412148, 0.000000000000000000, 0.005855590504225607, 0.000000000000000000, 0.006401286783911277, 0.000000000000000000, 0.006990181306750123, 0.000000000000000000, 0.007626424567085178, 0.000000000000000000, 0.008314851520255883, 0.000000000000000000, 0.009061139683747135, 0.000000000000000000, 0.009872011537848968, 0.000000000000000000, 0.010755496313062237, 0.000000000000000000, 0.011721272439718031, 0.000000000000000000, 0.012781121134483500, 0.000000000000000000, 0.013949535528809384, 0.000000000000000000, 0.015244551273554119, 0.000000000000000000, 0.016688898584430931, 0.000000000000000000, 0.018311630846033072, 0.000000000000000000, 0.020150476814457717, 0.000000000000000000, 0.022255321565352600, 0.000000000000000000, 0.024693503177301100, 0.000000000000000000, 0.027558135563807963, 0.000000000000000000, 0.030981687165876175, 0.000000000000000000, 0.035159143774044777, 0.000000000000000000, 0.040389700574458606, 0.000000000000000000, 0.047156937867897229, 0.000000000000000000, 0.056296459573201306, 0.000000000000000000, 0.069387047614511754, 0.000000000000000000, 0.089812363821891061, 0.000000000000000000, 0.126370732214445475, 0.000000000000000000, 0.211324043214114715, 0.000000000000000000, 0.635033486245172751, 0.000000000000000000,-0.635033486245172751, 0.000000000000000000,-0.211324043214114715, 0.000000000000000000,-0.126370732214445475, 0.000000000000000000,-0.089812363821891061, 0.000000000000000000,-0.069387047614511754, 0.000000000000000000,-0.056296459573201306, 0.000000000000000000,-0.047156937867897229, 0.000000000000000000,-0.040389700574458606, 0.000000000000000000,-0.035159143774044777, 0.000000000000000000,-0.030981687165876175, 0.000000000000000000,-0.027558135563807963, 0.000000000000000000,-0.024693503177301100, 0.000000000000000000,-0.022255321565352600, 0.000000000000000000,-0.020150476814457717, 0.000000000000000000,-0.018311630846033072, 0.000000000000000000,-0.016688898584430931, 0.000000000000000000,-0.015244551273554119, 0.000000000000000000,-0.013949535528809384, 0.000000000000000000,-0.012781121134483500, 0.000000000000000000,-0.011721272439718031, 0.000000000000000000,-0.010755496313062237, 0.000000000000000000,-0.009872011537848968, 0.000000000000000000,-0.009061139683747135, 0.000000000000000000,-0.008314851520255883, 0.000000000000000000,-0.007626424567085178, 0.000000000000000000,-0.006990181306750123, 0.000000000000000000,-0.006401286783911277, 0.000000000000000000,-0.005855590504225607, 0.000000000000000000,-0.005349501779412148, 0.000000000000000000,-0.004879890607273629, 0.000000000000000000,-0.004444008249195281, 0.000000000000000000,-0.004039423148679463, 0.000000000000000000,-0.003663968905292113, 0.000000000000000000,-0.003315701801645692, 0.000000000000000000,-0.002992865959230020, 0.000000000000000000,-0.002693864631427011, 0.000000000000000000,-0.002417236466741860, 0.000000000000000000,-0.002161635822912572, 0.000000000000000000,-0.001925816401721571, 0.000000000000000000,-0.001708617620559288, 0.000000000000000000,-0.001508953250504772, 0.000000000000000000,-0.001325801939712967, 0.000000000000000000,-0.001158199311056187, 0.000000000000000000,-0.001005231378692548, 0.000000000000000000,-0.000866029072658519, 0.000000000000000000,-0.000739763696285730, 0.000000000000000000,-0.000625643170080525, 0.000000000000000000,-0.000522908939129710, 0.000000000000000000,-0.000430833440231578, 0.000000000000000000,-0.000348718040684899, 0.000000000000000000};
static const float32_t FIR_HILB_Q_coeffs[IQ_HILBERT_TAPS] = {-0.000056786545255326, 263.1346287525080E-18,-0.000071793697491707, 391.3417109364890E-18,-0.000088874802368221, 336.4125900077540E-18,-0.000108170884956264, 392.7791496728210E-18,-0.000129819032785321, 590.4838201243310E-18,-0.000153950719729993, 596.8112038672230E-18,-0.000180690067531663, 746.3322026715040E-18,-0.000210152062867355, 1.093346048537350E-15,-0.000242440749545727, 1.065677310743770E-15,-0.000277647416860387, 1.039585124576320E-15,-0.000315848806349421, 1.538815826232670E-15,-0.000357105360160803, 1.666207014701170E-15,-0.000401459534874215, 1.539685561133540E-15,-0.000448934204947304, 2.660369443631100E-15,-0.000499531179987328, 3.040479628793550E-15,-0.000553229859656923, 1.044067344343770E-15,-0.000609986049322792, 2.032026148997660E-15,-0.000669730958505527, 6.994036442534390E-15,-0.000732370402749788, 7.411458451156190E-15,-0.000797784227648926, 3.101364677149160E-15,-0.000865825971964948, 2.594164153512510E-15,-0.000936322783811445, 5.348323407953660E-15,-0.001009075601815882, 5.884744611617880E-15,-0.001083859609627728, 5.492731038694370E-15,-0.001160424969305250, 6.445309139376350E-15,-0.001238497835651963, 6.872918232978370E-15,-0.001317781650032627, 6.663418858584270E-15,-0.001397958708679671, 8.133197857946460E-15,-0.001478691996873688, 9.905768905631310E-15,-0.001559627276797271, 10.20890941488510E-15,-0.001640395413295664, 11.20755554836600E-15,-0.001720614918466468, 12.64985408146260E-15,-0.001799894692718967, 12.97295013621260E-15,-0.001877836936972348, 14.24353199778040E-15,-0.001954040207976172, 16.47390711328630E-15,-0.002028102586337237, 18.06444101550620E-15,-0.002099624924798889, 19.78135011594340E-15,-0.002168214142707746, 21.50931561512560E-15,-0.002233486531418778, 23.52243144574740E-15,-0.002295071034610703, 26.83685625665210E-15,-0.002352612467220998, 30.78295485673010E-15,-0.002405774636936983, 35.50722610113330E-15,-0.002454243332825246, 40.92479516392550E-15,-0.002497729146841703, 46.97877831911210E-15,-0.002535970095673103, 56.20264720417670E-15,-0.002568734012302652, 69.94947997469540E-15,-0.002595820679318180, 90.43954876597660E-15,-0.002617063678801859, 127.2729571918730E-15,-0.002632331936897800, 212.5921889885520E-15,-0.002641530944731846, 638.3507757132560E-15, 0.997207486382091335, 638.3507757132560E-15,-0.002641530944731846, 212.5921889885520E-15,-0.002632331936897800, 127.2729571918730E-15,-0.002617063678801859, 90.43954876597660E-15,-0.002595820679318180, 69.94947997469540E-15,-0.002568734012302652, 56.20264720417670E-15,-0.002535970095673103, 46.97877831911210E-15,-0.002497729146841703, 40.92479516392550E-15,-0.002454243332825246, 35.50722610113330E-15,-0.002405774636936983, 30.78295485673010E-15,-0.002352612467220998, 26.83685625665210E-15,-0.002295071034610703, 23.52243144574740E-15,-0.002233486531418778, 21.50931561512560E-15,-0.002168214142707746, 19.78135011594340E-15,-0.002099624924798889, 18.06444101550620E-15,-0.002028102586337237, 16.47390711328630E-15,-0.001954040207976172, 14.24353199778040E-15,-0.001877836936972348, 12.97295013621260E-15,-0.001799894692718967, 12.64985408146260E-15,-0.001720614918466468, 11.20755554836600E-15,-0.001640395413295664, 10.20890941488510E-15,-0.001559627276797271, 9.905768905631310E-15,-0.001478691996873688, 8.133197857946460E-15,-0.001397958708679671, 6.663418858584270E-15,-0.001317781650032627, 6.872918232978370E-15,-0.001238497835651963, 6.445309139376350E-15,-0.001160424969305250, 5.492731038694370E-15,-0.001083859609627728, 5.884744611617880E-15,-0.001009075601815882, 5.348323407953660E-15,-0.000936322783811445, 2.594164153512510E-15,-0.000865825971964948, 3.101364677149160E-15,-0.000797784227648926, 7.411458451156190E-15,-0.000732370402749788, 6.994036442534390E-15,-0.000669730958505527, 2.032026148997660E-15,-0.000609986049322792, 1.044067344343770E-15,-0.000553229859656923, 3.040479628793550E-15,-0.000499531179987328, 2.660369443631100E-15,-0.000448934204947304, 1.539685561133540E-15,-0.000401459534874215, 1.666207014701170E-15,-0.000357105360160803, 1.538815826232670E-15,-0.000315848806349421, 1.039585124576320E-15,-0.000277647416860387, 1.065677310743770E-15,-0.000242440749545727, 1.093346048537350E-15,-0.000210152062867355, 746.3322026715040E-18,-0.000180690067531663, 596.8112038672230E-18,-0.000153950719729993, 590.4838201243310E-18,-0.000129819032785321, 392.7791496728210E-18,-0.000108170884956264, 336.4125900077540E-18,-0.000088874802368221, 391.3417109364890E-18,-0.000071793697491707, 263.1346287525080E-18,-0.000056786545255326};

static const IIR_BIQUAD_FILTER IIR_Biquad_Filters[IIR_FILTERS_COUNT] = (const IIR_BIQUAD_FILTER[]){
	//IIR RX/TX IIR Highpass Fs=48000 Apass=1 Astop=120 // coefficients converted to Direct-Form II Transposed by MATLAB // https://ua3reo.ru/services/matlab_to_arm_biquad.php
	{
		.width = 60,
		.type = IIR_BIQUAD_HPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.9998945186242, 0, 0, 0, 0, 1, -2, 1, 1.999758132887, -0.99981994161, 0.9996889367649, 0, 0, 0, 0, 1, -2, 1, 1.999343665899, -0.9994120811608, 0.9993922022251, 0, 0, 0, 0, 1, -2, 1, 1.99874202768, -0.9988267812205, 0.9988594148129, 0, 0, 0, 0, 1, -2, 1, 1.997658474509, -0.9977791847428, 0.9976379235525, 0, 0, 0, 0, 1, -2, 1, 1.995171008271, -0.9953806859393, 0.993575273017, 0, 0, 0, 0, 1, -2, 1, 1.9868941568, -0.9874069352679, 0.9658298859242, 0, 0, 0, 0, 1, -2, 1, 1.930363237657, -0.9329563060393, 0.8912509381337, 0, 0, 0, 0},
	},
	{
		.width = 100,
		.type = IIR_BIQUAD_HPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.9998070433437, 0, 0, 0, 0, 1, -2, 1, 1.99952824718, -0.9996999261949, 0.9994626733323, 0, 0, 0, 0, 1, -2, 1, 1.998830345237, -0.9990203480919, 0.998963895279, 0, 0, 0, 0, 1, -2, 1, 1.997810125605, -0.9980454555113, 0.9980670102991, 0, 0, 0, 0, 1, -2, 1, 1.995966497435, -0.9963015437617, 0.9960114376034, 0, 0, 0, 0, 1, -2, 1, 1.991732125694, -0.99231362472, 0.9891973898471, 0, 0, 0, 0, 1, -2, 1, 1.977685712474, -0.9791038469146, 0.9436531717078, 0, 0, 0, 0, 1, -2, 1, 1.883787490005, -0.8908251968259, 0.8912509381337, 0, 0, 0, 0},
	},
	{
		.width = 200,
		.type = IIR_BIQUAD_HPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.9995283511221, 0, 0, 0, 0, 1, -2, 1, 1.998713410513, -0.9993999939754, 0.9988310262326, 0, 0, 0, 0, 1, -2, 1, 1.997282254376, -0.9980418505545, 0.9978125457543, 0, 0, 0, 0, 1, -2, 1, 1.995154933871, -0.9960952491464, 0.9959747660947, 0, 0, 0, 0, 1, -2, 1, 1.991280786954, -0.9926182774253, 0.9917669813622, 0, 0, 0, 0, 1, -2, 1, 1.98237582151, -0.9846921039384, 0.9779386809936, 0, 0, 0, 0, 1, -2, 1, 1.953073134305, -0.9586815896694, 0.8903472269478, 0, 0, 0, 0, 1, -2, 1, 1.767413007236, -0.7939759005556, 0.8912509381337, 0, 0, 0, 0},
	},
	{
		.width = 300,
		.type = IIR_BIQUAD_HPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.9991640098344, 0, 0, 0, 0, 1, -2, 1, 1.997555784552, -0.9991002547852, 0.998105326748, 0, 0, 0, 0, 1, -2, 1, 1.995356606708, -0.9970647002838, 0.9965466117696, 0, 0, 0, 0, 1, -2, 1, 1.992036560075, -0.9941498870033, 0.9937250727065, 0, 0, 0, 0, 1, -2, 1, 1.985948652965, -0.9889516378612, 0.9872730937592, 0, 0, 0, 0, 1, -2, 1, 1.971951806778, -0.9771405682585, 0.9662614994334, 0, 0, 0, 0, 1, -2, 1, 1.926287935636, -0.9387580620975, 0.8400927948412, 0, 0, 0, 0, 1, -2, 1, 1.651985027197, -0.7083861521682, 0.8912509381337, 0, 0, 0, 0},
	},
	{
		.width = 400,
		.type = IIR_BIQUAD_HPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.9987141206486, 0, 0, 0, 0, 1, -2, 1, 1.996055722606, -0.9988007599883, 0.997285863546, 0, 0, 0, 0, 1, -2, 1, 1.993054364875, -0.9960890893095, 0.9951667918349, 0, 0, 0, 0, 1, -2, 1, 1.988457296701, -0.9922098706388, 0.9913198227663, 0, 0, 0, 0, 1, -2, 1, 1.979976254042, -0.9853030370226, 0.982536466246, 0, 0, 0, 0, 1, -2, 1, 1.960481910207, -0.9696639547771, 0.9542033020911, 0, 0, 0, 0, 1, -2, 1, 1.897458185064, -0.9193550233007, 0.7928443133024, 0, 0, 0, 0, 1, -2, 1, 1.538364485671, -0.6330127675387, 0.8912509381337, 0, 0, 0, 0},
	},
	{
		.width = 500,
		.type = IIR_BIQUAD_HPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.9981787993571, 0, 0, 0, 0, 1, -2, 1, 1.994213636568, -0.9985015608603, 0.9963729457258, 0, 0, 0, 0, 1, -2, 1, 1.990376574159, -0.9951152087441, 0.9936738219286, 0, 0, 0, 0, 1, -2, 1, 1.98441959088, -0.9902756968342, 0.9887609930392, 0, 0, 0, 0, 1, -2, 1, 1.973370111394, -0.9816738607631, 0.9775639982538, 0, 0, 0, 0, 1, -2, 1, 1.947988992653, -0.9622670003627, 0.9418011512827, 0, 0, 0, 0, 1, -2, 1, 1.866713400754, -0.9004912043762, 0.748515491982, 0, 0, 0, 0, 1, -2, 1, 1.427203352458, -0.5668586154696, 0.8912509381337, 0, 0, 0, 0},
	},
	{
		.width = 600,
		.type = IIR_BIQUAD_HPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.9969037824263,0,0,0,0,1,-2,1,1.990795297224,-0.9968198324812,0.9931822701974,0,0,0,0,1,-2,1,1.983050359135,-0.9896787216551,0.9877876948143,0,0,0,0,1,-2,1,1.971515887953,-0.9796348913037,0.9783275919713,0,0,0,0,1,-2,1,1.951002106013,-0.9623082618723,0.9581310983205,0,0,0,0,1,-2,1,1.906941380887,-0.925583012395,0.9036874190888,0,0,0,0,1,-2,1,1.78791793237,-0.8268317439854,0.7453244647305,0,0,0,0,1,-2,1,1.44153089566,-0.5397669632614,0.9885530946569,0,0,0,0},
	},
	//used for the FM noise squelch
	{
		.width = 15000,
		.type = IIR_BIQUAD_HPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.3049851455408, 0, 0, 0, 0, 1, -2, 1, -0.7591287465444, -0.9790693287075, 0.2780078711753, 0, 0, 0, 0, 1, -2, 1, -0.8256589275237, -0.9376904122248, 0.2323960275367, 0, 0, 0, 0, 1, -2, 1, -0.9664437350711, -0.8960278452179, 0.1720665990118, 0, 0, 0, 0, 1, -2, 1, -1.165936151782, -0.8542025478295, 0.1051104068231, 0, 0, 0, 0, 1, -2, 1, -1.394079028152, -0.8145206554444, 0.04513708899945, 0, 0, 0, 0, 1, -2, 1, -1.601425033622, -0.78197338962, 0.008951452064989, 0, 0, 0, 0, 1, -2, 1, -1.727386349532, -0.7631921577923, 0.8912509381337, 0, 0, 0, 0},
	},
	{
		.width = 20000,
		.type = IIR_BIQUAD_HPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.0664759669061, 0, 0, 0, 0, 1, -2, 1, -1.722719616758, -0.9886234843822, 0.05976585969453, 0, 0, 0, 0, 1, -2, 1, -1.727533129144, -0.9665965679221, 0.04829462608705, 0, 0, 0, 0, 1, -2, 1, -1.752941532896, -0.9461200372446, 0.03407949397928, 0, 0, 0, 0, 1, -2, 1, -1.791673048598, -0.9279910245151, 0.0197409684492, 0, 0, 0, 0, 1, -2, 1, -1.834168405903, -0.9131322796994, 0.00809367952317, 0, 0, 0, 0, 1, -2, 1, -1.870134827536, -0.9025095456287, 0.001562021017125, 0, 0, 0, 0, 1, -2, 1, -1.890706281461, -0.8969543655294, 0.8912509381337, 0, 0, 0, 0},
	},
	//IIR RX/TX IIR Lowpass Fs=48000 Apass=1 Astop=120 (Cheb I) // coefficients converted to Direct-Form II Transposed by MATLAB // https://ua3reo.ru/services/matlab_to_arm_biquad.php
	{
		.width = 100,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){4.539450359013e-05, 0, 0, 0, 0, 1, 2, 1, 1.999028523047, -0.9992101010613, 4.12288081265e-05, 0, 0, 0, 0, 1, 2, 1, 1.997506780172, -0.9976716954041, 3.376133302787e-05, 0, 0, 0, 0, 1, 2, 1, 1.996117028124, -0.9962520734564, 2.447083275459e-05, 0, 0, 0, 0, 1, 2, 1, 1.994923891324, -0.995021774655, 1.519349983938e-05, 0, 0, 0, 0, 1, 2, 1, 1.993980928911, -0.9940417029101, 7.760519448069e-06, 0, 0, 0, 0, 1, 2, 1, 1.993329184089, -0.9933602261669, 3.637722767719e-06, 0, 0, 0, 0, 1, 2, 1, 1.99299634873, -0.9930108996208, 0.9988493699365, 0, 0, 0, 0},
	},
	{
		.width = 100, //gauss Q30
		.type = IIR_BIQUAD_LPF_GAUSS,
		.stages = 3,
		.coeffs = (float32_t[]){0.0002143270359125, 0, 0, 0, 0, 1, 0, -1, 1.999528518437, -0.9995713459282, 1, 0, 0, 0, 0},
	},
	{
		.width = 150,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.0001021153183143, 0, 0, 0, 0, 1, 2, 1, 1.998406970325, -0.9988154315983, 9.270938491961e-05, 0, 0, 0, 0, 1, 2, 1, 1.99613885485, -0.9965096923895, 7.589139552644e-05, 0, 0, 0, 0, 1, 2, 1, 1.994079944126, -0.9943835097077, 5.499121373331e-05, 0, 0, 0, 0, 1, 2, 1, 1.992322074332, -0.9925420391871, 3.413509721096e-05, 0, 0, 0, 0, 1, 2, 1, 1.990939317829, -0.9910758582178, 1.743268416824e-05, 0, 0, 0, 0, 1, 2, 1, 1.989987033295, -0.9900567640316, 8.170853770195e-06, 0, 0, 0, 0, 1, 2, 1, 1.989501813572, -0.9895344969874, 0.9988493699365, 0, 0, 0, 0},
	},
	{
		.width = 150, //gauss Q30
		.type = IIR_BIQUAD_LPF_GAUSS,
		.stages = 3,
		.coeffs = (float32_t[]){0.0003214561070949, 0, 0, 0, 0, 1, 0, -1, 1.999260736687, -0.9993570877858, 1, 0, 0, 0, 0},
	},
	{
		.width = 200,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.0001814971641605, 0, 0, 0, 0, 1, 2, 1, 1.997694984539, -0.9984209731954, 0.0001647172147428, 0, 0, 0, 0, 1, 2, 1, 1.994690312494, -0.9953491813535, 0.0001347906349762, 0, 0, 0, 0, 1, 2, 1, 1.991979442145, -0.9925186046848, 9.764148740718e-05, 0, 0, 0, 0, 1, 2, 1, 1.989678008556, -0.9900685745059, 6.059590459572e-05, 0, 0, 0, 0, 1, 2, 1, 1.987876452094, -0.9881188357119, 3.094128670946e-05, 0, 0, 0, 0, 1, 2, 1, 1.986640371813, -0.9867641369597, 1.450129967991e-05, 0, 0, 0, 0, 1, 2, 1, 1.986012030386, -0.9860700355851, 0.9988493699365, 0, 0, 0, 0},
	},
	{
		.width = 200, //gauss Q30
		.type = IIR_BIQUAD_LPF_GAUSS,
		.stages = 3,
		.coeffs = (float32_t[]){0.0004285622244523, 0, 0, 0, 0, 1, 0, -1, 1.998971604131, -0.9991428755511, 1, 0, 0, 0, 0},
	},
	{
		.width = 250,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.0002835226227315, 0, 0, 0, 0, 1, 2, 1, 1.996892653613, -0.9980267441042, 0.0002572137958149, 0, 0, 0, 0, 1, 2, 1, 1.993161351185, -0.9941902063681, 0.0002104111428965, 0, 0, 0, 0, 1, 2, 1, 1.989815757641, -0.9906574022129, 0.0001523770623605, 0, 0, 0, 0, 1, 2, 1, 1.98699188654, -0.987601394789, 9.454352893827e-05, 0, 0, 0, 0, 1, 2, 1, 1.984792426234, -0.9851706003496, 4.826815547137e-05, 0, 0, 0, 0, 1, 2, 1, 1.983289187212, -0.9834822598334, 2.262015873526e-05, 0, 0, 0, 0, 1, 2, 1, 1.982526918414, -0.9826173990485, 0.9988493699365, 0, 0, 0, 0},
	},
	{
		.width = 250, //gauss Q30
		.type = IIR_BIQUAD_LPF_GAUSS,
		.stages = 3,
		.coeffs = (float32_t[]){0.0005356453959978, 0, 0, 0, 0, 1, 0, -1, 1.998661128432, -0.998928709208, 1, 0, 0, 0, 0},
	},
	{
		.width = 300,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.0004081731515733, 0, 0, 0, 0, 1, 2, 1, 1.996000069937, -0.9976327625435, 0.0003701599504112, 0, 0, 0, 0, 1, 2, 1, 1.991552171487, -0.9930328112887, 0.0003027049419703, 0, 0, 0, 0, 1, 2, 1, 1.987589125987, -0.9887999457554, 0.0002191537240887, 0, 0, 0, 0, 1, 2, 1, 1.984263899077, -0.985140513973, 0.0001359460715114, 0, 0, 0, 0, 1, 2, 1, 1.981687333, -0.9822311172865, 6.939547667807e-05, 0, 0, 0, 0, 1, 2, 1, 1.979933466399, -0.9802110483061, 3.251872410702e-05, 0, 0, 0, 0, 1, 2, 1, 1.979046397288, -0.9791764721843, 0.9988493699365, 0, 0, 0, 0},
	},
	{
		.width = 300, //gauss Q30
		.type = IIR_BIQUAD_LPF_GAUSS,
		.stages = 3,
		.coeffs = (float32_t[]){0.0006427056297418, 0, 0, 0, 0, 1, 0, -1, 1.99832931748, -0.9987145887405, 1, 0, 0, 0, 0},
	},
	{
		.width = 350,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.0005554290877296, 0, 0, 0, 0, 1, 2, 1, 1.995017330347, -0.9972390466978, 0.0005035158316726, 0, 0, 0, 0, 1, 2, 1, 1.989862976426, -0.9918770397532, 0.0004116239907127, 0, 0, 0, 0, 1, 2, 1, 1.985299782455, -0.9869462784174, 0.0002979276347989, 0, 0, 0, 0, 1, 2, 1, 1.981494235221, -0.9826859457606, 0.0001847721244628, 0, 0, 0, 0, 1, 2, 1, 1.978561263381, -0.9793003518787, 9.43057909553e-05, 0, 0, 0, 0, 1, 2, 1, 1.976573195631, -0.9769504187951, 4.418848181852e-05, 0, 0, 0, 0, 1, 2, 1, 1.975570387029, -0.975747140956, 0.9988493699365, 0, 0, 0, 0},
	},
	{
		.width = 350, //gauss Q30
		.type = IIR_BIQUAD_LPF_GAUSS,
		.stages = 3,
		.coeffs = (float32_t[]){0.0007497429336899, 0, 0, 0, 0, 1, 0, -1, 1.997976179388, -0.9985005141326, 1, 0, 0, 0, 0},
	},
	{
		.width = 400,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.000725269651369, 0, 0, 0, 0, 1, 2, 1, 1.993944536111, -0.9968456147164, 0.0006572409303878, 0, 0, 0, 0, 1, 2, 1, 1.98809397146, -0.9907229351816, 0.0005371201880512, 0, 0, 0, 0, 1, 2, 1, 1.982947962197, -0.9850964429495, 0.0003886553331689, 0, 0, 0, 0, 1, 2, 1, 1.978683082294, -0.9802377036265, 0.0002409907674018, 0, 0, 0, 0, 1, 2, 1, 1.975414306616, -0.9763782696854, 0.0001229819899735, 0, 0, 0, 0, 1, 2, 1, 1.973208360515, -0.9737002884744, 5.762110871163e-05, 0, 0, 0, 0, 1, 2, 1, 1.972098808033, -0.9723292924676, 0.9988493699365, 0, 0, 0, 0},
	},
	{
		.width = 400, //gauss Q30
		.type = IIR_BIQUAD_LPF_GAUSS,
		.stages = 3,
		.coeffs = (float32_t[]){0.0008567573158444, 0, 0, 0, 0, 1, 0, -1, 1.997601722498, -0.9982864853683, 1, 0, 0, 0, 0},
	},
	{
		.width = 450,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.0009176729494843, 0, 0, 0, 0, 1, 2, 1, 1.992781792915, -0.9964524847126, 0.0008312940817485, 0, 0, 0, 0, 1, 2, 1, 1.986245364449, -0.9895705407758, 0.0006791453778202, 0, 0, 0, 0, 1, 2, 1, 1.98053390024, -0.983250481751, 0.0004912937340662, 0, 0, 0, 0, 1, 2, 1, 1.975830625887, -0.9777958008235, 0.0003045715640265, 0, 0, 0, 0, 1, 2, 1, 1.972246550215, -0.9734648364713, 0.0001554073131561, 0, 0, 0, 0, 1, 2, 1, 1.969838946015, -0.9704605752676, 7.280847045795e-05, 0, 0, 0, 0, 1, 2, 1, 1.968631581067, -0.9689228149491, 0.9988493699365, 0, 0, 0, 0},
	},
	{
		.width = 450, //gauss Q30
		.type = IIR_BIQUAD_LPF_GAUSS,
		.stages = 3,
		.coeffs = (float32_t[]){0.0009637487842045, 0, 0, 0, 0, 1, 0, -1, 1.997205955375, -0.9980725024316, 1, 0, 0, 0, 0},
	},
	{
		.width = 500,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.001132615979662, 0, 0, 0, 0, 1, 2, 1, 1.991529210844, -0.9960596747624, 0.001025633472075, 0, 0, 0, 0, 1, 2, 1, 1.984317365631, -0.9884198995192, 0.0008376513531685, 0, 0, 0, 0, 1, 2, 1, 1.978057831461, -0.9814084368739, 0.0006058001282267, 0, 0, 0, 0, 1, 2, 1, 1.972937049876, -0.9753602503892, 0.00037548455879, 0, 0, 0, 0, 1, 2, 1, 1.969058079974, -0.9705600182088, 0.0001915653444512, 0, 0, 0, 0, 1, 2, 1, 1.966464936463, -0.9672311978408, 8.974261961447e-05, 0, 0, 0, 0, 1, 2, 1, 1.965168627262, -0.9655275977408, 0.9988493699365, 0, 0, 0, 0},
	},
	{
		.width = 500, //gauss Q30
		.type = IIR_BIQUAD_LPF_GAUSS,
		.stages = 3,
		.coeffs = (float32_t[]){0.001070717346765, 0, 0, 0, 0, 1, 0, -1, 1.99678888681, -0.9978585653065, 1, 0, 0, 0, 0},
	},
	{
		.width = 550,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.001370074633923, 0, 0, 0, 0, 1, 2, 1, 1.990186904368, -0.9956672029039, 0.001240216645515, 0, 0, 0, 0, 1, 2, 1, 1.982310187594, -0.9872710541757, 0.001012589860882, 0, 0, 0, 0, 1, 2, 1, 1.975519990583, -0.9795703500261, 0.000732132181896, 0, 0, 0, 0, 1, 2, 1, 1.970002536424, -0.9729310651515, 0.0004537002736072, 0, 0, 0, 0, 1, 2, 1, 1.965848979986, -0.9676637810804, 0.0002314400091674, 0, 0, 0, 0, 1, 2, 1, 1.963086315559, -0.9640120755954, 0.0001084157937229, 0, 0, 0, 0, 1, 2, 1, 1.961709868104, -0.9621435312791, 0.9988493699365, 0, 0, 0, 0},
	},
	{
		.width = 550, //gauss Q30
		.type = IIR_BIQUAD_LPF_GAUSS,
		.stages = 3,
		.coeffs = (float32_t[]){0.001177663011516, 0, 0, 0, 0, 1, 0, -1, 1.99635052582, -0.997644673977, 1, 0, 0, 0, 0},
	},
	{
		.width = 600,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.001630023702634, 0, 0, 0, 0, 1, 2, 1, 1.988754992325, -0.9952750871359, 0.001475000510709, 0, 0, 0, 0, 1, 2, 1, 1.980224045247, -0.9861240472902, 0.001203912605622, 0, 0, 0, 0, 1, 2, 1, 1.972920612153, -0.9777362625752, 0.0008702479364331, 0, 0, 0, 0, 1, 2, 1, 1.967027265989, -0.970508257735, 0.0005391897046009, 0, 0, 0, 0, 1, 2, 1, 1.962619332663, -0.9647760914809, 0.0002750155708716, 0, 0, 0, 0, 1, 2, 1, 1.959703066378, -0.9608031286616, 0.0001288204134519, 0, 0, 0, 0, 1, 2, 1, 1.958255225428, -0.9587705070814, 0.9988493699365, 0, 0, 0, 0},
	},
	{
		.width = 600, //gauss Q30
		.type = IIR_BIQUAD_LPF_GAUSS,
		.stages = 3,
		.coeffs = (float32_t[]){0.001284585786447, 0, 0, 0, 0, 1, 0, -1, 1.995890881647, -0.9974308284271, 1, 0, 0, 0, 0},
	},
	{
		.width = 650,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.001912436878482, 0, 0, 0, 0, 1, 2, 1, 1.987233597903, -0.9948833454173, 0.00172994134743, 0, 0, 0, 0, 1, 2, 1, 1.978059155798, -0.9849789211876, 0.001411571254077, 0, 0, 0, 0, 1, 2, 1, 1.970259930536, -0.9759062155519, 0.001020105807877, 0, 0, 0, 0, 1, 2, 1, 1.964011417335, -0.9680918405668, 0.0006319243188875, 0, 0, 0, 0, 1, 2, 1, 1.959369218744, -0.9618969160194, 0.0003222766283481, 0, 0, 0, 0, 1, 2, 1, 1.956315171378, -0.9576042778917, 0.0001509490807821, 0, 0, 0, 0, 1, 2, 1, 1.954804621409, -0.955408417732, 0.9988493699365, 0, 0, 0, 0},
	},
	{
		.width = 650, //gauss Q30
		.type = IIR_BIQUAD_LPF_GAUSS,
		.stages = 3,
		.coeffs = (float32_t[]){0.001391485679541, 0, 0, 0, 0, 1, 0, -1, 1.995409963756, -0.9972170286409, 1, 0, 0, 0, 0},
	},
	{
		.width = 700,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.002217286760527, 0, 0, 0, 0, 1, 2, 1, 1.985622848624, -0.9944919956662, 0.002004994813189, 0, 0, 0, 0, 1, 2, 1, 1.97581573872, -0.9838357179728, 0.001635517439036, 0, 0, 0, 0, 1, 2, 1, 1.967538179897, -0.9740802496536, 0.001181664586478, 0, 0, 0, 0, 1, 2, 1, 1.960955167537, -0.9656818258825, 0.0007318760514019, 0, 0, 0, 0, 1, 2, 1, 1.956098717316, -0.9590262215216, 0.000373208112619, 0, 0, 0, 0, 1, 2, 1, 1.952922612402, -0.9544154448529, 0.0001747945772321, 0, 0, 0, 0, 1, 2, 1, 1.951357978559, -0.952057156868, 0.9988493699365, 0, 0, 0, 0},
	},
	{
		.width = 700, //gauss Q30
		.type = IIR_BIQUAD_LPF_GAUSS,
		.stages = 3,
		.coeffs = (float32_t[]){0.001498362698778, 0, 0, 0, 0, 1, 0, -1, 1.99490778184, -0.9970032746024, 1, 0, 0, 0, 0},
	},
	{
		.width = 750,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.002544544858308, 0, 0, 0, 0, 1, 2, 1, 1.983922876325, -0.9941010557584, 0.002300115949807, 0, 0, 0, 0, 1, 2, 1, 1.973494015731, -0.98269447953, 0.001875702763374, 0, 0, 0, 0, 1, 2, 1, 1.964755594194, -0.9722584052479, 0.001354883436197, 0, 0, 0, 0, 1, 2, 1, 1.957858691987, -0.9632782257319, 0.0008390173017621, 0, 0, 0, 0, 1, 2, 1, 1.952807905825, -0.9561639750321, 0.0004277952840239, 0, 0, 0, 0, 1, 2, 1, 1.949525370685, -0.9512365518212, 0.0002003498621258, 0, 0, 0, 0, 1, 2, 1, 1.947915219717, -0.9487166191655, 0.9988493699365, 0, 0, 0, 0},
	},
	{
		.width = 750, //gauss Q30
		.type = IIR_BIQUAD_LPF_GAUSS,
		.stages = 3,
		.coeffs = (float32_t[]){0.001605216852135, 0, 0, 0, 0, 1, 0, -1, 1.994384345814, -0.9967895662957, 1, 0, 0, 0, 0},
	},
	{
		.width = 800,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.002894181596032, 0, 0, 0, 0, 1, 2, 1, 1.982133817143, -0.993710543527, 0.002615259189961, 0, 0, 0, 0, 1, 2, 1, 1.971094210763, -0.9815552475233, 0.00213207880396, 0, 0, 0, 0, 1, 2, 1, 1.96191240716, -0.9704407223763, 0.001539721894163, 0, 0, 0, 0, 1, 2, 1, 1.954722164408, -0.960881051985, 0.0009533209311722, 0, 0, 0, 0, 1, 2, 1, 1.949496860091, -0.9533101438158, 0.0004860237293597, 0, 0, 0, 0, 1, 2, 1, 1.946123426857, -0.9480675217744, 0.0002276080709008, 0, 0, 0, 0, 1, 2, 1, 1.944476268042, -0.9453867003256, 0.9988493699365, 0, 0, 0, 0},
	},
	{
		.width = 800, //gauss Q30
		.type = IIR_BIQUAD_LPF_GAUSS,
		.stages = 3,
		.coeffs = (float32_t[]){0.001712048147584, 0, 0, 0, 0, 1, 0, -1, 1.993839665819, -0.9965759037048, 1, 0, 0, 0, 0},
	},
	{
		.width = 850,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.003266166316811, 0, 0, 0, 0, 1, 2, 1, 1.980255811494, -0.9933204767613, 0.002950378363692, 0, 0, 0, 0, 1, 2, 1, 1.968616549941, -0.9804180633954, 0.002404597115477, 0, 0, 0, 0, 1, 2, 1, 1.959008852296, -0.9686272407575, 0.00173613987011, 0, 0, 0, 0, 1, 2, 1, 1.951545756857, -0.9584903163374, 0.001074760259365, 0, 0, 0, 0, 1, 2, 1, 1.946165654323, -0.9504646953608, 0.0005478793590777, 0, 0, 0, 0, 1, 2, 1, 1.94271676095, -0.9449082783863, 0.000256562513455, 0, 0, 0, 0, 1, 2, 1, 1.941041047007, -0.9420672970612, 0.9988493699365, 0, 0, 0, 0},
	},
	{
		.width = 850, //gauss Q30
		.type = IIR_BIQUAD_LPF_GAUSS,
		.stages = 3,
		.coeffs = (float32_t[]){0.001818856593095, 0, 0, 0, 0, 1, 0, -1, 1.993273752219, -0.9963622868138, 1, 0, 0, 0, 0},
	},
	{
		.width = 900,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.003660467286978, 0, 0, 0, 0, 1, 2, 1, 1.978289004058, -0.9929308732058, 0.003305426704878, 0, 0, 0, 0, 1, 2, 1, 1.966061261549, -0.979282968368, 0.002693209234172, 0, 0, 0, 0, 1, 2, 1, 1.956045162854, -0.9668179997909, 0.001944097645772, 0, 0, 0, 0, 1, 2, 1, 1.948329639733, -0.9561060303163, 0.001203309061585, 0, 0, 0, 0, 1, 2, 1, 1.942814361133, -0.9476275973795, 0.0006133484045393, 0, 0, 0, 0, 1, 2, 1, 1.939305352402, -0.9417587460199, 0.0002872066725341, 0, 0, 0, 0, 1, 2, 1, 1.937609480393, -0.9387583070836, 0.9988493699365, 0, 0, 0, 0},
	},
	{
		.width = 900, //gauss Q30
		.type = IIR_BIQUAD_LPF_GAUSS,
		.stages = 3,
		.coeffs = (float32_t[]){0.001925642196633, 0, 0, 0, 0, 1, 0, -1, 1.992686615605, -0.9961487156067, 1, 0, 0, 0, 0},
	},
	{
		.width = 950,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.004077051700458, 0, 0, 0, 0, 1, 2, 1, 1.976233543758, -0.9925417505595, 0.003680356857678, 0, 0, 0, 0, 1, 2, 1, 1.963428576011, -0.9781500034417, 0.002997866681515, 0, 0, 0, 0, 1, 2, 1, 1.953021571835, -0.9650130385606, 0.002163555874249, 0, 0, 0, 0, 1, 2, 1, 1.945073981789, -0.9537282052858, 0.001338941565603, 0, 0, 0, 0, 1, 2, 1, 1.939443051549, -0.9447988178113, 0.0006824174153282, 0, 0, 0, 0, 1, 2, 1, 1.93588918006, -0.9386188497212, 0.0003195342021565, 0, 0, 0, 0, 1, 2, 1, 1.934181492281, -0.9354596290896, 0.9988493699365, 0, 0, 0, 0},
	},
	{
		.width = 950, //gauss Q30
		.type = IIR_BIQUAD_LPF_GAUSS,
		.stages = 3,
		.coeffs = (float32_t[]){0.00203240496616, 0, 0, 0, 0, 1, 0, -1, 1.992078266787, -0.9959351900677, 1, 0, 0, 0, 0},
	},
	{
		.width = 1000,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.004515885683206, 0, 0, 0, 0, 1, 2, 1, 1.974089583742, -0.9921531264746, 0.004075120882938, 0, 0, 0, 0, 1, 2, 1, 1.960718725863, -0.9770192093952, 0.003318520967785, 0, 0, 0, 0, 1, 2, 1, 1.949938311967, -0.9632123958382, 0.002394475579344, 0, 0, 0, 0, 1, 2, 1, 1.941778950135, -0.9513568524525, 0.001481632448781, 0, 0, 0, 0, 1, 2, 1, 1.936051795029, -0.9419783248239, 0.0007550732566187, 0, 0, 0, 0, 1, 2, 1, 1.932468222187, -0.9354885152133, 0.0003535389260766, 0, 0, 0, 0, 1, 2, 1, 1.930757007044, -0.9321711627487, 0.9988493699365, 0, 0, 0, 0},
	},
	{
		.width = 1000, //gauss Q30
		.type = IIR_BIQUAD_LPF_GAUSS,
		.stages = 3,
		.coeffs = (float32_t[]){0.002139144909634, 0, 0, 0, 0, 1, 0, -1, 1.991448716805, -0.9957217101807, 1, 0, 0, 0, 0},
	},
	{
		.width = 1400,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.008337759067718, 0, 0, 0, 0, 1, 2, 1, 1.962488019523, -0.9958390557937, 0.007506676076303, 0, 0, 0, 0, 1, 2, 1, 1.957738871263, -0.9877655755683, 0.006043957858058, 0, 0, 0, 0, 1, 2, 1, 1.956161255776, -0.9803370872084, 0.004235277493261, 0, 0, 0, 0, 1, 2, 1, 1.956962928023, -0.9739040379958, 0.002433354390642, 0, 0, 0, 0, 1, 2, 1, 1.959042241511, -0.9687756590733, 0.0009906129953076, 0, 0, 0, 0, 1, 2, 1, 1.961242450501, -0.9652049024823, 0.00019040061388, 0, 0, 0, 0, 1, 2, 1, 1.962610750926, -0.9633723533813, 0.8912509381337, 0, 0, 0, 0},
	},
	{
		.width = 1600,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.01087767183753, 0, 0, 0, 0, 1, 2, 1, 1.951743475923, -0.9952541632731, 0.009790251369373, 0, 0, 0, 0, 1, 2, 1, 1.946889322437, -0.9860503279146, 0.007881911933017, 0, 0, 0, 0, 1, 2, 1, 1.946054588275, -0.9775822360066, 0.005523739386766, 0, 0, 0, 0, 1, 2, 1, 1.948150114001, -0.9702450715483, 0.003174223932421, 0, 0, 0, 0, 1, 2, 1, 1.951694105105, -0.9643910008345, 0.001292461661961, 0, 0, 0, 0, 1, 2, 1, 1.955141533597, -0.9603113802446, 0.0002484458717897, 0, 0, 0, 0, 1, 2, 1, 1.957222530892, -0.9582163143789, 0.8912509381337, 0, 0, 0, 0},
	},
	{
		.width = 1800,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.01374975760108, 0, 0, 0, 0, 1, 2, 1, 1.939673816033, -0.9946728464377, 0.01237165909396, 0, 0, 0, 0, 1, 2, 1, 1.934859504021, -0.9843461403965, 0.00995992424776, 0, 0, 0, 0, 1, 2, 1, 1.935004390016, -0.9748440870071, 0.006981215584571, 0, 0, 0, 0, 1, 2, 1, 1.938680240252, -0.96660510259, 0.004012807567963, 0, 0, 0, 0, 1, 2, 1, 1.943973272573, -0.960024502845, 0.001634314057146, 0, 0, 0, 0, 1, 2, 1, 1.948896382515, -0.9554336387438, 0.0003142054006989, 0, 0, 0, 0, 1, 2, 1, 1.951817350883, -0.9530741724857, 0.8912509381337, 0, 0, 0, 0},
	},
	{
		.width = 2100,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.0186757712085, 0, 0, 0, 0, 1, 2, 1, 1.919105345061, -0.9938084298953, 0.01679782577699, 0, 0, 0, 0, 1, 2, 1, 1.914621379821, -0.9818126829289, 0.01352433909839, 0, 0, 0, 0, 1, 2, 1, 1.916673090488, -0.9707704468821, 0.009483344041549, 0, 0, 0, 0, 1, 2, 1, 1.923248669381, -0.9611820455475, 0.005453911681508, 0, 0, 0, 0, 1, 2, 1, 1.931692622294, -0.9535082690199, 0.002222306584324, 0, 0, 0, 0, 1, 2, 1, 1.939254929475, -0.948144155812, 0.0004273708029279, 0, 0, 0, 0, 1, 2, 1, 1.943673846642, -0.9453833298533, 0.8912509381337, 0, 0, 0, 0},
	},
	{
		.width = 2300,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.02236805492097, 0, 0, 0, 0, 1, 2, 1, 1.903765535654, -0.9932377553382, 0.02011484257157, 0, 0, 0, 0, 1, 2, 1, 1.899680932944, -0.9801403032298, 0.01619704186404, 0, 0, 0, 0, 1, 2, 1, 1.903290409888, -0.9680785773444, 0.01136147999554, 0, 0, 0, 0, 1, 2, 1, 1.91214621026, -0.9575921302427, 0.006536937451987, 0, 0, 0, 0, 1, 2, 1, 1.92303837058, -0.9491861203884, 0.002664657794376, 0, 0, 0, 0, 1, 2, 1, 1.932642344124, -0.9433009753017, 0.0005125568415544, 0, 0, 0, 0, 1, 2, 1, 1.938218356086, -0.9402685834517, 0.8912509381337, 0, 0, 0, 0},
	},
	{
		.width = 2500,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.02638375826711, 0, 0, 0, 0, 1, 2, 1, 1.887136976642, -0.9926720097103, 0.023722179526, 0, 0, 0, 0, 1, 2, 1, 1.883593567933, -0.9784822860373, 0.01910539136227, 0, 0, 0, 0, 1, 2, 1, 1.888985449532, -0.9654070149807, 0.0134072873595, 0, 0, 0, 0, 1, 2, 1, 1.900394125441, -0.9540232748791, 0.007718006483406, 0, 0, 0, 0, 1, 2, 1, 1.914009303952, -0.9448813298853, 0.003147525588083, 0, 0, 0, 0, 1, 2, 1, 1.925879604901, -0.9384697072535, 0.0006055973457388, 0, 0, 0, 0, 1, 2, 1, 1.932739506253, -0.9351618956361, 0.8912509381337, 0, 0, 0, 0},
	},
	{
		.width = 2700,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.03071990044993, 0, 0, 0, 0, 1, 2, 1, 1.869231969467, -0.9921115712663, 0.02761740656234, 0, 0, 0, 0, 1, 2, 1, 1.866369928111, -0.9768395543603, 0.02224808606729, 0, 0, 0, 0, 1, 2, 1, 1.873764434848, -0.9627567791176, 0.01562051628912, 0, 0, 0, 0, 1, 2, 1, 1.887994019063, -0.9504760842192, 0.008997387142466, 0, 0, 0, 0, 1, 2, 1, 1.904604155312, -0.9405937038814, 0.003671160986692, 0, 0, 0, 0, 1, 2, 1, 1.918964639434, -0.9336492833803, 0.0007065561783843, 0, 0, 0, 0, 1, 2, 1, 1.927235402943, -0.9300616276564, 0.8912509381337, 0, 0, 0, 0},
	},
	{
		.width = 2900,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.03537329213245, 0, 0, 0, 0, 1, 2, 1, 1.850063645572, -0.9915568141019, 0.03179797016664, 0, 0, 0, 0, 1, 2, 1, 1.848021141171, -0.9752130218375, 0.02562380547135, 0, 0, 0, 0, 1, 2, 1, 1.857633663767, -0.9601288856525, 0.01800097496312, 0, 0, 0, 0, 1, 2, 1, 1.874947272759, -0.9469511726113, 0.01037542521106, 0, 0, 0, 0, 1, 2, 1, 1.894821365712, -0.9363230665567, 0.004235862132326, 0, 0, 0, 0, 1, 2, 1, 1.911895202355, -0.9288386508847, 0.0008155080256104, 0, 0, 0, 0, 1, 2, 1, 1.92170411798, -0.9249661500829, 0.8912509381337, 0, 0, 0, 0},
	},
	{
		.width = 3000,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.0378179035225, 0, 0, 0, 0, 1, 2, 1, 1.840010067621, -0.991281681711, 0.03399442178565, 0, 0, 0, 0, 1, 2, 1, 1.838428426034, -0.9744061131769, 0.02739863142844, 0, 0, 0, 0, 1, 2, 1, 1.849229108307, -0.9588236340205, 0.01925387115406, 0, 0, 0, 0, 1, 2, 1, 1.868181781801, -0.9451972664171, 0.01110157002227, 0, 0, 0, 0, 1, 2, 1, 1.889787788767, -0.9341940688557, 0.004533718545948, 0, 0, 0, 0, 1, 2, 1, 1.908301807349, -0.9264366815325, 0.0008730076728553, 0, 0, 0, 0, 1, 2, 1, 1.918927669868, -0.9224197005598, 0.8912509381337, 0, 0, 0, 0},
	},
	{
		.width = 3200,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.04294074008438, 0, 0, 0, 0, 1, 2, 1, 1.818973177899, -0.9907361382365, 0.03859793564407, 0, 0, 0, 0, 1, 2, 1, 1.818413829065, -0.9728055716408, 0.03112136875327, 0, 0, 0, 0, 1, 2, 1, 1.831745678148, -0.9562311531615, 0.0218849394564, 0, 0, 0, 0, 1, 2, 1, 1.854167192034, -0.9417069498599, 0.01262841216123, 0, 0, 0, 0, 1, 2, 1, 1.879434978023, -0.9299486266681, 0.005160681770831, 0, 0, 0, 0, 1, 2, 1, 1.900996067857, -0.9216387949399, 0.0009941132114779, 0, 0, 0, 0, 1, 2, 1, 1.913351916063, -0.9173283689091, 0.8912509381337, 0, 0, 0, 0},
	},
	{
		.width = 3400,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.04837195881699, 0, 0, 0, 0, 1, 2, 1, 1.796709356328, -0.9901971915964, 0.04347987080713, 0, 0, 0, 0, 1, 2, 1, 1.797303988281, -0.9712234715099, 0.03507374176562, 0, 0, 0, 0, 1, 2, 1, 1.813368576892, -0.9536635439548, 0.02468300567677, 0, 0, 0, 0, 1, 2, 1, 1.839508477053, -0.93824049976, 0.01425511571928, 0, 0, 0, 0, 1, 2, 1, 1.868699356243, -0.9257198191201, 0.005829666089407, 0, 0, 0, 0, 1, 2, 1, 1.893529468422, -0.9168481327797, 0.001123447109388, 0, 0, 0, 0, 1, 2, 1, 1.90774399342, -0.9122377818571, 0.8912509381337, 0, 0, 0, 0},
	},
	{
		.width = 3600,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.05410766292916, 0, 0, 0, 0, 1, 2, 1, 1.773234547842, -0.9896651995582, 0.04863725173841, 0, 0, 0, 0, 1, 2, 1, 1.775111685656, -0.9696606926092, 0.03925435731034, 0, 0, 0, 0, 1, 2, 1, 1.794104386414, -0.9511218156552, 0.02764807346692, 0, 0, 0, 0, 1, 2, 1, 1.824206281656, -0.9347985755237, 0.01598229875604, 0, 0, 0, 0, 1, 2, 1, 1.857578346955, -0.9215075419793, 0.006541139568672, 0, 0, 0, 0, 1, 2, 1, 1.885899135105, -0.9120636933801, 0.00126112358591, 0, 0, 0, 0, 1, 2, 1, 1.902101832716, -0.9071463270599, 0.8912509381337, 0, 0, 0, 0},
	},
	{
		.width = 3800,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.06014376034101, 0, 0, 0, 0, 1, 2, 1, 1.748565473372, -0.9891405147361, 0.05406698488614, 0, 0, 0, 0, 1, 2, 1, 1.75185016527, -0.9681181048143, 0.04366179904764, 0, 0, 0, 0, 1, 2, 1, 1.773959780893, -0.9486069770836, 0.03078019985087, 0, 0, 0, 0, 1, 2, 1, 1.808261053311, -0.9313818527144, 0.01781065782937, 0, 0, 0, 0, 1, 2, 1, 1.846069082969, -0.9173117142862, 0.007295620714451, 0, 0, 0, 0, 1, 2, 1, 1.878102006143, -0.9072844890005, 0.001407268766049, 0, 0, 0, 0, 1, 2, 1, 1.896423317628, -0.9020523926923, 0.8912509381337, 0, 0, 0, 0},
	},
	{
		.width = 4000,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.0664759669061, 0, 0, 0, 0, 1, 2, 1, 1.722719616758, -0.9886234843822, 0.05976585969453, 0, 0, 0, 0, 1, 2, 1, 1.727533129144, -0.9665965679221, 0.04829462608705, 0, 0, 0, 0, 1, 2, 1, 1.752941532896, -0.9461200372446, 0.03407949397928, 0, 0, 0, 0, 1, 2, 1, 1.791673048598, -0.9279910245151, 0.0197409684492, 0, 0, 0, 0, 1, 2, 1, 1.834168405903, -0.9131322796994, 0.00809367952317, 0, 0, 0, 0, 1, 2, 1, 1.870134827536, -0.9025095456287, 0.001562021017125, 0, 0, 0, 0, 1, 2, 1, 1.890706281461, -0.8969543655294, 0.8912509381337, 0, 0, 0, 0},
	},
	{
		.width = 4500,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.08357215221717, 0, 0, 0, 0, 1, 2, 1, 1.653078015998, -0.987366624867, 0.07516842731719, 0, 0, 0, 0, 1, 2, 1, 1.662216664048, -0.9628903733163, 0.06085305871942, 0, 0, 0, 0, 1, 2, 1, 1.696619139932, -0.9400313748092, 0.043060258968, 0, 0, 0, 0, 1, 2, 1, 1.747390932282, -0.9196319681538, 0.02501859112256, 0, 0, 0, 0, 1, 2, 1, 1.802680917653, -0.9027552821436, 0.01028369816962, 0, 0, 0, 0, 1, 2, 1, 1.849449766852, -0.8905845595302, 0.001987580597066, 0, 0, 0, 0, 1, 2, 1, 1.876230447368, -0.8841807697568, 0.8912509381337, 0, 0, 0, 0},
	},
	{
		.width = 5000,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.1024156725791, 0, 0, 0, 0, 1, 2, 1, 1.576502212425, -0.9861649027415, 0.09217691252119, 0, 0, 0, 0, 1, 2, 1, 1.590626367525, -0.9593340176097, 0.07478718663087, 0, 0, 0, 0, 1, 2, 1, 1.63499047411, -0.9341392206335, 0.0530907744763, 0, 0, 0, 0, 1, 2, 1, 1.699087884799, -0.9114509827042, 0.03095453675841, 0, 0, 0, 0, 1, 2, 1, 1.768662790286, -0.8924809373192, 0.01276135116726, 0, 0, 0, 0, 1, 2, 1, 1.827620197021, -0.8786656016897, 0.002470638805861, 0, 0, 0, 0, 1, 2, 1, 1.861463480239, -0.8713460354626, 0.8912509381337, 0, 0, 0, 0},
	},
	{
		.width = 6000,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.1450110967848, 0, 0, 0, 0, 1, 2, 1, 1.403901955866, -0.9839463430048, 0.1307691226309, 0, 0, 0, 0, 1, 2, 1, 1.429644184424, -0.9527206749475, 0.1066810357534, 0, 0, 0, 0, 1, 2, 1, 1.496284169193, -0.9230083122063, 0.07632499046678, 0, 0, 0, 0, 1, 2, 1, 1.590375038731, -0.8956750005979, 0.04487973895608, 0, 0, 0, 0, 1, 2, 1, 1.692728831788, -0.8722477876128, 0.01863599384496, 0, 0, 0, 0, 1, 2, 1, 1.780245937312, -0.8547899126915, 0.003623004541629, 0, 0, 0, 0, 1, 2, 1, 1.830897212635, -0.8453892308013, 0.8912509381337, 0, 0, 0, 0},
	},
	{
		.width = 7000,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.1935320872064, 0, 0, 0, 0, 1, 2, 1, 1.207875690811, -0.9820040396369, 0.1750141161592, 0, 0, 0, 0, 1, 2, 1, 1.246795349816, -0.9468518144529, 0.1437565297358, 0, 0, 0, 0, 1, 2, 1, 1.337830681316, -0.9128568002589, 0.1038445422874, 0, 0, 0, 0, 1, 2, 1, 1.465400321994, -0.8807784911441, 0.06170673134055, 0, 0, 0, 0, 1, 2, 1, 1.605636412052, -0.8524633374146, 0.02585632577245, 0, 0, 0, 0, 1, 2, 1, 1.727351325001, -0.8307766280909, 0.005053269625901, 0, 0, 0, 0, 1, 2, 1, 1.798655982283, -0.8188690607867, 0.8912509381337, 0, 0, 0, 0},
	},
	{
		.width = 8000,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.2471567962157, 0, 0, 0, 0, 1, 2, 1, 0.9917423657721, -0.9803695506349, 0.224315091642, 0, 0, 0, 0, 1, 2, 1, 1.044554840447, -0.9418152070148, 0.1857606943562, 0, 0, 0, 0, 1, 2, 1, 1.160774872447, -0.9038176498723, 0.1357293808017, 0, 0, 0, 0, 1, 2, 1, 1.323981745373, -0.8668992685794, 0.0816816657689, 0, 0, 0, 0, 1, 2, 1, 1.506461203918, -0.8331878669936, 0.0346084620725, 0, 0, 0, 0, 1, 2, 1, 1.668097114322, -0.8065309626121, 0.006808262659746, 0, 0, 0, 0, 1, 2, 1, 1.764321649588, -0.7915547002269, 0.8912509381337, 0, 0, 0, 0},
	},
	{
		.width = 9000,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.3049851455408, 0, 0, 0, 0, 1, 2, 1, 0.7591287465444, -0.9790693287075, 0.2780078711753, 0, 0, 0, 0, 1, 2, 1, 0.8256589275237, -0.9376904122248, 0.2323960275367, 0, 0, 0, 0, 1, 2, 1, 0.9664437350711, -0.8960278452179, 0.1720665990118, 0, 0, 0, 0, 1, 2, 1, 1.165936151782, -0.8542025478295, 0.1051104068231, 0, 0, 0, 0, 1, 2, 1, 1.394079028152, -0.8145206554444, 0.04513708899945, 0, 0, 0, 0, 1, 2, 1, 1.601425033622, -0.78197338962, 0.008951452064989, 0, 0, 0, 0, 1, 2, 1, 1.727386349532, -0.7631921577923, 0.8912509381337, 0, 0, 0, 0},
	},
	{
		.width = 10000,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.3660530366546, 0, 0, 0, 0, 1, 2, 1, 0.5139122219498, -0.9781243685681, 0.3353618895079, 0, 0, 0, 0, 1, 2, 1, 0.5931003386238, -0.9345478966556, 0.2833072224337, 0, 0, 0, 0, 1, 2, 1, 0.7563993155832, -0.889628205318, 0.2129361875021, 0, 0, 0, 0, 1, 2, 1, 0.9911412275405, -0.8428859775489, 0.1323619182589, 0, 0, 0, 0, 1, 2, 1, 1.267164478707, -0.7966121517422, 0.0577608794396, 0, 0, 0, 0, 1, 2, 1, 1.526003705736, -0.7570472234945, 0.01156881757925, 0, 0, 0, 0, 1, 2, 1, 1.687220763409, -0.7334960337262, 0.8912509381337, 0, 0, 0, 0},
	},
	{
		.width = 15000,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.6836575636023, 0, 0, 0, 0, 1, 2, 1, -0.7555775647369, -0.9790526896722, 0.647099990577, 0, 0, 0, 0, 1, 2, 1, -0.6531521361674, -0.9352478261406, 0.5835442055703, 0, 0, 0, 0, 1, 2, 1, -0.4507362158414, -0.8834406064397, 0.4845398400426, 0, 0, 0, 0, 1, 2, 1, -0.1214617070015, -0.816697653169, 0.343041904988, 0, 0, 0, 0, 1, 2, 1, 0.3575721235141, -0.729739743466, 0.1720099445637, 0, 0, 0, 0, 1, 2, 1, 0.9410108109328, -0.6290505891876, 0.03796886246342, 0, 0, 0, 0, 1, 2, 1, 1.399673185533, -0.5515486353869, 0.8912509381337, 0, 0, 0, 0},
	},
	{
		.width = 20000,
		.type = IIR_BIQUAD_LPF,
		.stages = 15,
		.coeffs = (float32_t[]){0.9275653605469, 0, 0, 0, 0, 1, 2, 1, -1.721658533587, -0.9886029086012, 0.9093240243363, 0, 0, 0, 0, 1, 2, 1, -1.673785057778, -0.9635110395671, 0.8781513561579, 0, 0, 0, 0, 1, 2, 1, -1.582945488801, -0.9296599358312, 0.8220243799729, 0, 0, 0, 0, 1, 2, 1, -1.41280229903, -0.8752952208621, 0.712966251766, 0, 0, 0, 0, 1, 2, 1, -1.07711451342, -0.7747504936445, 0.4918611014088, 0, 0, 0, 0, 1, 2, 1, -0.3928110912436, -0.5746333143917, 0.1540100983629, 0, 0, 0, 0, 1, 2, 1, 0.6545074245328, -0.2705478179843, 0.8912509381337, 0, 0, 0, 0},
	},
};

//LPF Decimation FIR, decimate by 2 (20-24khz)
arm_fir_decimate_instance_f32 DECIMATE_2_RX1_AUDIO_I =
	{
		.M = 2,
		.numTaps = 64,
		.pCoeffs = (float32_t *)(const float32_t[64]){-0.0008892337321673, 0.003477894238503,-0.002185262246017,-0.001984932762417,0.001685648105394, 0.002926913337573, -0.00145160850299,-0.004198797432128,0.0009455904305857, 0.005721447322426, 8.21440436747e-05,-0.007388997878029,-0.001829651596965, 0.009044897147744,  0.00447080257142, -0.01044571172923,-0.008186822710222,  0.01128313127609,  0.01314765114768,  -0.0111479760402,-0.01956587456314, 0.009479959497416,  0.02780160284385,-0.005417691590933,-0.03865638709278,-0.002675459627177,  0.05429664947513,   0.0190245886159,-0.08234006032775, -0.06101935776334,   0.1724056527095,   0.4240751620668,0.4240751620668,   0.1724056527095, -0.06101935776334, -0.08234006032775,0.0190245886159,  0.05429664947513,-0.002675459627177, -0.03865638709278,-0.005417691590933,  0.02780160284385, 0.009479959497416, -0.01956587456314,-0.0111479760402,  0.01314765114768,  0.01128313127609,-0.008186822710222,-0.01044571172923,  0.00447080257142, 0.009044897147744,-0.001829651596965,-0.007388997878029, 8.21440436747e-05, 0.005721447322426,0.0009455904305857,-0.004198797432128, -0.00145160850299, 0.002926913337573, 0.001685648105394,-0.001984932762417,-0.002185262246017, 0.003477894238503,-0.0008892337321673},
		.pState = (float32_t[FPGA_RX_IQ_BUFFER_HALF_SIZE + 64 - 1]){0}};
arm_fir_decimate_instance_f32 DECIMATE_2_RX1_AUDIO_Q =
	{
		.M = 2,
		.numTaps = 64,
		.pCoeffs = (float32_t *)(const float32_t[64]){475.1179397144384210E-6f, 0.503905202786044337f, 0.503905202786044337f, 475.1179397144384210E-6f},
		.pState = (float32_t[FPGA_RX_IQ_BUFFER_HALF_SIZE + 64 - 1]){0}};
arm_fir_decimate_instance_f32 DECIMATE_2_RX2_AUDIO_I =
	{
		.M = 2,
		.numTaps = 64,
		.pCoeffs = (float32_t *)(const float32_t[64]){475.1179397144384210E-6f, 0.503905202786044337f, 0.503905202786044337f, 475.1179397144384210E-6f},
		.pState = (float32_t[FPGA_RX_IQ_BUFFER_HALF_SIZE + 64 - 1]){0}};
arm_fir_decimate_instance_f32 DECIMATE_2_RX2_AUDIO_Q =
	{
		.M = 2,
		.numTaps = 64,
		.pCoeffs = (float32_t *)(const float32_t[64]){475.1179397144384210E-6f, 0.503905202786044337f, 0.503905202786044337f, 475.1179397144384210E-6f},
		.pState = (float32_t[FPGA_RX_IQ_BUFFER_HALF_SIZE + 64 - 1]){0}};

//LPF Decimation FIR, decimate by 4 (20-24khz)
arm_fir_decimate_instance_f32 DECIMATE_4_RX1_AUDIO_I =
	{
		.M = 4,
		.numTaps = 64,
		.pCoeffs = (float32_t *)(const float32_t[64]){0.0138021817771,  -0.0378311637337, 0.002941882405535,  0.01332998839231, 0.0117825373679, 0.005459328584745,-0.002173136036067,-0.008397165086789, -0.01078701045133,-0.007951002964217,-0.0007020965392168, 0.007761248364852, 0.01314664071891,  0.01216617788128,  0.00430285692941,-0.007199400827497, -0.0165855404426, -0.01836027447007, -0.01002873389022, 0.005574254392264, 0.02127111425323,  0.02817918247186,  0.02038798124361,-0.001401812869685, -0.02871364734698, -0.04770403709605, -0.04450401283562, -0.01140647294122, 0.04878024954034,   0.1224269130136,   0.1890425805167,   0.2285571467894, 0.2285571467894,   0.1890425805167,   0.1224269130136,  0.04878024954034, -0.01140647294122, -0.04450401283562, -0.04770403709605, -0.02871364734698, -0.001401812869685,  0.02038798124361,  0.02817918247186,  0.02127111425323, 0.005574254392264, -0.01002873389022, -0.01836027447007,  -0.0165855404426, -0.007199400827497,  0.00430285692941,  0.01216617788128,  0.01314664071891, 0.007761248364852,-0.0007020965392168,-0.007951002964217, -0.01078701045133, -0.008397165086789,-0.002173136036067, 0.005459328584745,   0.0117825373679, 0.01332998839231, 0.002941882405535,  -0.0378311637337,   0.0138021817771},
		.pState = (float32_t[FPGA_RX_IQ_BUFFER_HALF_SIZE + 64 - 1]){0}};
arm_fir_decimate_instance_f32 DECIMATE_4_RX1_AUDIO_Q =
	{
		.M = 4,
		.numTaps = 64,
		.pCoeffs = (float32_t *)(const float32_t[64]){0.0138021817771,  -0.0378311637337, 0.002941882405535,  0.01332998839231, 0.0117825373679, 0.005459328584745,-0.002173136036067,-0.008397165086789, -0.01078701045133,-0.007951002964217,-0.0007020965392168, 0.007761248364852, 0.01314664071891,  0.01216617788128,  0.00430285692941,-0.007199400827497, -0.0165855404426, -0.01836027447007, -0.01002873389022, 0.005574254392264, 0.02127111425323,  0.02817918247186,  0.02038798124361,-0.001401812869685, -0.02871364734698, -0.04770403709605, -0.04450401283562, -0.01140647294122, 0.04878024954034,   0.1224269130136,   0.1890425805167,   0.2285571467894, 0.2285571467894,   0.1890425805167,   0.1224269130136,  0.04878024954034, -0.01140647294122, -0.04450401283562, -0.04770403709605, -0.02871364734698, -0.001401812869685,  0.02038798124361,  0.02817918247186,  0.02127111425323, 0.005574254392264, -0.01002873389022, -0.01836027447007,  -0.0165855404426, -0.007199400827497,  0.00430285692941,  0.01216617788128,  0.01314664071891, 0.007761248364852,-0.0007020965392168,-0.007951002964217, -0.01078701045133, -0.008397165086789,-0.002173136036067, 0.005459328584745,   0.0117825373679, 0.01332998839231, 0.002941882405535,  -0.0378311637337,   0.0138021817771},
		.pState = (float32_t[FPGA_RX_IQ_BUFFER_HALF_SIZE + 64 - 1]){0}};
arm_fir_decimate_instance_f32 DECIMATE_4_RX2_AUDIO_I =
	{
		.M = 4,
		.numTaps = 64,
		.pCoeffs = (float32_t *)(const float32_t[64]){0.0138021817771,  -0.0378311637337, 0.002941882405535,  0.01332998839231, 0.0117825373679, 0.005459328584745,-0.002173136036067,-0.008397165086789, -0.01078701045133,-0.007951002964217,-0.0007020965392168, 0.007761248364852, 0.01314664071891,  0.01216617788128,  0.00430285692941,-0.007199400827497, -0.0165855404426, -0.01836027447007, -0.01002873389022, 0.005574254392264, 0.02127111425323,  0.02817918247186,  0.02038798124361,-0.001401812869685, -0.02871364734698, -0.04770403709605, -0.04450401283562, -0.01140647294122, 0.04878024954034,   0.1224269130136,   0.1890425805167,   0.2285571467894, 0.2285571467894,   0.1890425805167,   0.1224269130136,  0.04878024954034, -0.01140647294122, -0.04450401283562, -0.04770403709605, -0.02871364734698, -0.001401812869685,  0.02038798124361,  0.02817918247186,  0.02127111425323, 0.005574254392264, -0.01002873389022, -0.01836027447007,  -0.0165855404426, -0.007199400827497,  0.00430285692941,  0.01216617788128,  0.01314664071891, 0.007761248364852,-0.0007020965392168,-0.007951002964217, -0.01078701045133, -0.008397165086789,-0.002173136036067, 0.005459328584745,   0.0117825373679, 0.01332998839231, 0.002941882405535,  -0.0378311637337,   0.0138021817771},
		.pState = (float32_t[FPGA_RX_IQ_BUFFER_HALF_SIZE + 64 - 1]){0}};
arm_fir_decimate_instance_f32 DECIMATE_4_RX2_AUDIO_Q =
	{
		.M = 4,
		.numTaps = 64,
		.pCoeffs = (float32_t *)(const float32_t[64]){0.0138021817771,  -0.0378311637337, 0.002941882405535,  0.01332998839231, 0.0117825373679, 0.005459328584745,-0.002173136036067,-0.008397165086789, -0.01078701045133,-0.007951002964217,-0.0007020965392168, 0.007761248364852, 0.01314664071891,  0.01216617788128,  0.00430285692941,-0.007199400827497, -0.0165855404426, -0.01836027447007, -0.01002873389022, 0.005574254392264, 0.02127111425323,  0.02817918247186,  0.02038798124361,-0.001401812869685, -0.02871364734698, -0.04770403709605, -0.04450401283562, -0.01140647294122, 0.04878024954034,   0.1224269130136,   0.1890425805167,   0.2285571467894, 0.2285571467894,   0.1890425805167,   0.1224269130136,  0.04878024954034, -0.01140647294122, -0.04450401283562, -0.04770403709605, -0.02871364734698, -0.001401812869685,  0.02038798124361,  0.02817918247186,  0.02127111425323, 0.005574254392264, -0.01002873389022, -0.01836027447007,  -0.0165855404426, -0.007199400827497,  0.00430285692941,  0.01216617788128,  0.01314664071891, 0.007761248364852,-0.0007020965392168,-0.007951002964217, -0.01078701045133, -0.008397165086789,-0.002173136036067, 0.005459328584745,   0.0117825373679, 0.01332998839231, 0.002941882405535,  -0.0378311637337,   0.0138021817771},
		.pState = (float32_t[FPGA_RX_IQ_BUFFER_HALF_SIZE + 64 - 1]){0}};

//LPF Decimation FIR, decimate by 8 (20-24khz)
arm_fir_decimate_instance_f32 DECIMATE_8_RX1_AUDIO_I =
	{
		.M = 8,
		.numTaps = 64,
		.pCoeffs = (float32_t *)(const float32_t[64]){0.1141881425352, -0.06784934914731,  -0.0474565268158, -0.03086439474794,-0.0174052898182,-0.006518692838192, 0.002156013286414, 0.008812210690898,0.0135716786905,  0.01641708228943,  0.01720310101956,  0.01600019400403,0.01278251903863, 0.007817648032539,  0.00147304353337,-0.005663612098684,-0.01282680243501, -0.01916694650342, -0.02377527926682,  -0.0258839622708,-0.02479590879283, -0.02005718839019, -0.01148696612059,0.0007428681746102,0.01605531765337,  0.03357144226569,  0.05201492523172,  0.07044685231363,0.08707497902084,   0.1010354287024,   0.1109868889571,   0.1160424522016,0.1160424522016,   0.1109868889571,   0.1010354287024,  0.08707497902084,0.07044685231363,  0.05201492523172,  0.03357144226569,  0.01605531765337,0.0007428681746102, -0.01148696612059, -0.02005718839019, -0.02479590879283,-0.0258839622708, -0.02377527926682, -0.01916694650342, -0.01282680243501,-0.005663612098684,  0.00147304353337, 0.007817648032539,  0.01278251903863,0.01600019400403,  0.01720310101956,  0.01641708228943,   0.0135716786905,0.008812210690898, 0.002156013286414,-0.006518692838192,  -0.0174052898182,-0.03086439474794,  -0.0474565268158, -0.06784934914731,   0.1141881425352},
		.pState = (float32_t[FPGA_RX_IQ_BUFFER_HALF_SIZE + 64 - 1]){0}};
arm_fir_decimate_instance_f32 DECIMATE_8_RX1_AUDIO_Q =
	{
		.M = 8,
		.numTaps = 64,
		.pCoeffs = (float32_t *)(const float32_t[64]){0.1141881425352, -0.06784934914731,  -0.0474565268158, -0.03086439474794,-0.0174052898182,-0.006518692838192, 0.002156013286414, 0.008812210690898,0.0135716786905,  0.01641708228943,  0.01720310101956,  0.01600019400403,0.01278251903863, 0.007817648032539,  0.00147304353337,-0.005663612098684,-0.01282680243501, -0.01916694650342, -0.02377527926682,  -0.0258839622708,-0.02479590879283, -0.02005718839019, -0.01148696612059,0.0007428681746102,0.01605531765337,  0.03357144226569,  0.05201492523172,  0.07044685231363,0.08707497902084,   0.1010354287024,   0.1109868889571,   0.1160424522016,0.1160424522016,   0.1109868889571,   0.1010354287024,  0.08707497902084,0.07044685231363,  0.05201492523172,  0.03357144226569,  0.01605531765337,0.0007428681746102, -0.01148696612059, -0.02005718839019, -0.02479590879283,-0.0258839622708, -0.02377527926682, -0.01916694650342, -0.01282680243501,-0.005663612098684,  0.00147304353337, 0.007817648032539,  0.01278251903863,0.01600019400403,  0.01720310101956,  0.01641708228943,   0.0135716786905,0.008812210690898, 0.002156013286414,-0.006518692838192,  -0.0174052898182,-0.03086439474794,  -0.0474565268158, -0.06784934914731,   0.1141881425352},
		.pState = (float32_t[FPGA_RX_IQ_BUFFER_HALF_SIZE + 64 - 1]){0}};
arm_fir_decimate_instance_f32 DECIMATE_8_RX2_AUDIO_I =
	{
		.M = 8,
		.numTaps = 64,
		.pCoeffs = (float32_t *)(const float32_t[64]){0.1141881425352, -0.06784934914731,  -0.0474565268158, -0.03086439474794,-0.0174052898182,-0.006518692838192, 0.002156013286414, 0.008812210690898,0.0135716786905,  0.01641708228943,  0.01720310101956,  0.01600019400403,0.01278251903863, 0.007817648032539,  0.00147304353337,-0.005663612098684,-0.01282680243501, -0.01916694650342, -0.02377527926682,  -0.0258839622708,-0.02479590879283, -0.02005718839019, -0.01148696612059,0.0007428681746102,0.01605531765337,  0.03357144226569,  0.05201492523172,  0.07044685231363,0.08707497902084,   0.1010354287024,   0.1109868889571,   0.1160424522016,0.1160424522016,   0.1109868889571,   0.1010354287024,  0.08707497902084,0.07044685231363,  0.05201492523172,  0.03357144226569,  0.01605531765337,0.0007428681746102, -0.01148696612059, -0.02005718839019, -0.02479590879283,-0.0258839622708, -0.02377527926682, -0.01916694650342, -0.01282680243501,-0.005663612098684,  0.00147304353337, 0.007817648032539,  0.01278251903863,0.01600019400403,  0.01720310101956,  0.01641708228943,   0.0135716786905,0.008812210690898, 0.002156013286414,-0.006518692838192,  -0.0174052898182,-0.03086439474794,  -0.0474565268158, -0.06784934914731,   0.1141881425352},
		.pState = (float32_t[FPGA_RX_IQ_BUFFER_HALF_SIZE + 64 - 1]){0}};
arm_fir_decimate_instance_f32 DECIMATE_8_RX2_AUDIO_Q =
	{
		.M = 8,
		.numTaps = 64,
		.pCoeffs = (float32_t *)(const float32_t[64]){0.1141881425352, -0.06784934914731,  -0.0474565268158, -0.03086439474794,-0.0174052898182,-0.006518692838192, 0.002156013286414, 0.008812210690898,0.0135716786905,  0.01641708228943,  0.01720310101956,  0.01600019400403,0.01278251903863, 0.007817648032539,  0.00147304353337,-0.005663612098684,-0.01282680243501, -0.01916694650342, -0.02377527926682,  -0.0258839622708,-0.02479590879283, -0.02005718839019, -0.01148696612059,0.0007428681746102,0.01605531765337,  0.03357144226569,  0.05201492523172,  0.07044685231363,0.08707497902084,   0.1010354287024,   0.1109868889571,   0.1160424522016,0.1160424522016,   0.1109868889571,   0.1010354287024,  0.08707497902084,0.07044685231363,  0.05201492523172,  0.03357144226569,  0.01605531765337,0.0007428681746102, -0.01148696612059, -0.02005718839019, -0.02479590879283,-0.0258839622708, -0.02377527926682, -0.01916694650342, -0.01282680243501,-0.005663612098684,  0.00147304353337, 0.007817648032539,  0.01278251903863,0.01600019400403,  0.01720310101956,  0.01641708228943,   0.0135716786905,0.008812210690898, 0.002156013286414,-0.006518692838192,  -0.0174052898182,-0.03086439474794,  -0.0474565268158, -0.06784934914731,   0.1141881425352},
		.pState = (float32_t[FPGA_RX_IQ_BUFFER_HALF_SIZE + 64 - 1]){0}};

//Public variables

const uint32_t AUTIO_FILTERS_HPF_CW_LIST[CW_HPF_COUNT] = {0, 60, 100};
const uint32_t AUTIO_FILTERS_HPF_SSB_LIST[SSB_HPF_COUNT] = {0, 60, 100, 200, 300, 400, 500};
const uint32_t AUTIO_FILTERS_LPF_CW_LIST[CW_LPF_COUNT] = {100, 150, 200, 250, 300, 350, 400, 450, 500, 550, 600, 650, 700, 750, 800, 850, 900, 950, 1000};
const uint32_t AUTIO_FILTERS_LPF_SSB_LIST[SSB_LPF_COUNT] = {1400, 1600, 1800, 2100, 2300, 2500, 2700, 2900, 3000, 3200, 3400};
const uint32_t AUTIO_FILTERS_LPF_AM_LIST[AM_LPF_COUNT] = {2100, 2300, 2500, 2700, 2900, 3000, 3200, 3400, 3600, 3800, 4000, 4500, 5000, 6000, 7000, 8000, 9000, 10000};
const uint32_t AUTIO_FILTERS_LPF_NFM_LIST[NFM_LPF_COUNT] = {5000, 6000, 7000, 8000, 9000, 10000, 15000, 20000};

arm_fir_instance_f32 FIR_RX1_Hilbert_I; // filter instances
arm_fir_instance_f32 FIR_RX1_Hilbert_Q;
arm_fir_instance_f32 FIR_RX2_Hilbert_I;
arm_fir_instance_f32 FIR_RX2_Hilbert_Q;
arm_fir_instance_f32 FIR_TX_Hilbert_I;
arm_fir_instance_f32 FIR_TX_Hilbert_Q;
arm_biquad_cascade_df2T_instance_f32 IIR_RX1_LPF_I;
arm_biquad_cascade_df2T_instance_f32 IIR_RX1_LPF_Q;
arm_biquad_cascade_df2T_instance_f32 IIR_RX1_GAUSS;
arm_biquad_cascade_df2T_instance_f32 IIR_RX2_LPF_I;
arm_biquad_cascade_df2T_instance_f32 IIR_RX2_LPF_Q;
arm_biquad_cascade_df2T_instance_f32 IIR_RX2_GAUSS;
arm_biquad_cascade_df2T_instance_f32 IIR_TX_LPF_I;
arm_biquad_cascade_df2T_instance_f32 IIR_RX1_HPF_I;
arm_biquad_cascade_df2T_instance_f32 IIR_RX2_HPF_I;
arm_biquad_cascade_df2T_instance_f32 IIR_TX_HPF_I;
arm_biquad_cascade_df2T_instance_f32 IIR_RX1_Squelch_HPF;
arm_biquad_cascade_df2T_instance_f32 IIR_RX2_Squelch_HPF;
arm_biquad_cascade_df2T_instance_f32 NOTCH_RX1_FILTER = {NOTCH_STAGES, NOTCH_RX1_State, NOTCH_RX1_Coeffs}; // manual notch filter
arm_biquad_cascade_df2T_instance_f32 NOTCH_RX2_FILTER = {NOTCH_STAGES, NOTCH_RX2_State, NOTCH_RX2_Coeffs};
arm_biquad_cascade_df2T_instance_f32 NOTCH_FFT_I_FILTER = {NOTCH_STAGES, NOTCH_FFT_I_State, NOTCH_RX1_Coeffs};
arm_biquad_cascade_df2T_instance_f32 NOTCH_FFT_Q_FILTER = {NOTCH_STAGES, NOTCH_FFT_Q_State, NOTCH_RX1_Coeffs};
arm_biquad_cascade_df2T_instance_f32 EQ_RX_LOW_FILTER = {EQ_STAGES, EQ_RX_LOW_FILTER_State, EQ_RX_LOW_FILTER_Coeffs};
arm_biquad_cascade_df2T_instance_f32 EQ_RX_MID_FILTER = {EQ_STAGES, EQ_RX_MID_FILTER_State, EQ_RX_MID_FILTER_Coeffs};
arm_biquad_cascade_df2T_instance_f32 EQ_RX_HIG_FILTER = {EQ_STAGES, EQ_RX_HIG_FILTER_State, EQ_RX_HIG_FILTER_Coeffs};
arm_biquad_cascade_df2T_instance_f32 EQ_MIC_LOW_FILTER = {EQ_STAGES, EQ_MIC_LOW_FILTER_State, EQ_MIC_LOW_FILTER_Coeffs};
arm_biquad_cascade_df2T_instance_f32 EQ_MIC_MID_FILTER = {EQ_STAGES, EQ_MIC_MID_FILTER_State, EQ_MIC_MID_FILTER_Coeffs};
arm_biquad_cascade_df2T_instance_f32 EQ_MIC_HIG_FILTER = {EQ_STAGES, EQ_MIC_HIG_FILTER_State, EQ_MIC_HIG_FILTER_Coeffs};
arm_biquad_cascade_df2T_instance_f32 AGC_RX1_KW_HSHELF_FILTER = {EQ_STAGES, AGC_RX1_KW_HSHELF_FILTER_State, AGC_RX_KW_HSHELF_FILTER_Coeffs};
arm_biquad_cascade_df2T_instance_f32 AGC_RX1_KW_HPASS_FILTER = {EQ_STAGES, AGC_RX1_KW_HPASS_FILTER_State, AGC_RX_KW_HPASS_FILTER_Coeffs};
arm_biquad_cascade_df2T_instance_f32 AGC_RX2_KW_HSHELF_FILTER = {EQ_STAGES, AGC_RX2_KW_HSHELF_FILTER_State, AGC_RX_KW_HSHELF_FILTER_Coeffs};
arm_biquad_cascade_df2T_instance_f32 AGC_RX2_KW_HPASS_FILTER = {EQ_STAGES, AGC_RX2_KW_HPASS_FILTER_State, AGC_RX_KW_HPASS_FILTER_Coeffs};
volatile bool NeedReinitNotch = false;			   // need to re-initialize the manual Notch filter
volatile bool NeedReinitAudioFilters = false;	   // need to re-initialize Audio filters
volatile bool NeedReinitAudioFiltersClean = false; //also clean state

// Prototypes
static void calcBiquad(BIQUAD_TYPE type, uint32_t Fc, uint32_t Fs, float32_t Q, float32_t peakGain, float32_t *outCoeffs);									  // automatic calculation of the Biquad filter for Notch
static IIR_BIQUAD_FILTER *getIIRFilter(IIR_BIQUAD_FILTER_TYPE type, uint_fast16_t width);																	  // get filter from collection
static void arm_biquad_cascade_df2T_initNoClean_f32(arm_biquad_cascade_df2T_instance_f32 *S, uint8_t numStages, const float32_t *pCoeffs, float32_t *pState); //init without state-clean version

// initialize audio filters
void InitAudioFilters(void)
{
	//TX Hilbert
	arm_fir_init_f32(&FIR_TX_Hilbert_I, IQ_HILBERT_TAPS, (float32_t *)&FIR_HILB_I_coeffs, (float32_t *)&Fir_Tx_Hilbert_State_I[0], AUDIO_BUFFER_HALF_SIZE);
	arm_fir_init_f32(&FIR_TX_Hilbert_Q, IQ_HILBERT_TAPS, (float32_t *)&FIR_HILB_Q_coeffs, (float32_t *)&Fir_Tx_Hilbert_State_Q[0], AUDIO_BUFFER_HALF_SIZE);

	//AGC K-Weight LKFS BS.1770
	calcBiquad(BIQUAD_highShelf, 1500, TRX_SAMPLERATE, 1.0f / sqrtf(2), 4.0f, AGC_RX_KW_HSHELF_FILTER_Coeffs);
	calcBiquad(BIQUAD_highpass, 38, TRX_SAMPLERATE, 0.5f, 0.0f, AGC_RX_KW_HPASS_FILTER_Coeffs);

	//Other
	InitNoiseReduction();
	InitNotchFilter();
	InitAutoNotchReduction();
	InitVAD();
	ReinitAudioFilters();
}

// reinitialize audio filters
void ReinitAudioFilters(void)
{
	//RX1 Hilbert
	if (CurrentVFO()->Mode == TRX_MODE_CW_L || CurrentVFO()->Mode == TRX_MODE_CW_U)
	{
		arm_fir_init_f32(&FIR_RX1_Hilbert_I, IQ_HILBERT_TAPS, (float32_t *)&FIR_HILB_I_coeffs, (float32_t *)&Fir_RX1_Hilbert_State_I[0], AUDIO_BUFFER_HALF_SIZE);
		arm_fir_init_f32(&FIR_RX1_Hilbert_Q, IQ_HILBERT_TAPS, (float32_t *)&FIR_HILB_Q_coeffs, (float32_t *)&Fir_RX1_Hilbert_State_Q[0], AUDIO_BUFFER_HALF_SIZE);
	}
	else
	{
		arm_fir_init_f32(&FIR_RX1_Hilbert_I, IQ_HILBERT_TAPS, (float32_t *)&FIR_HILB_I_coeffs, (float32_t *)&Fir_RX1_Hilbert_State_I[0], AUDIO_BUFFER_HALF_SIZE);
		arm_fir_init_f32(&FIR_RX1_Hilbert_Q, IQ_HILBERT_TAPS, (float32_t *)&FIR_HILB_Q_coeffs, (float32_t *)&Fir_RX1_Hilbert_State_Q[0], AUDIO_BUFFER_HALF_SIZE);
	}

	//RX2 Hilbert
	if (SecondaryVFO()->Mode == TRX_MODE_CW_L || SecondaryVFO()->Mode == TRX_MODE_CW_U)
	{
		arm_fir_init_f32(&FIR_RX2_Hilbert_I, IQ_HILBERT_TAPS, (float32_t *)&FIR_HILB_I_coeffs, (float32_t *)&Fir_RX2_Hilbert_State_I[0], AUDIO_BUFFER_HALF_SIZE);
		arm_fir_init_f32(&FIR_RX2_Hilbert_Q, IQ_HILBERT_TAPS, (float32_t *)&FIR_HILB_Q_coeffs, (float32_t *)&Fir_RX2_Hilbert_State_Q[0], AUDIO_BUFFER_HALF_SIZE);
	}
	else
	{
		arm_fir_init_f32(&FIR_RX2_Hilbert_I, IQ_HILBERT_TAPS, (float32_t *)&FIR_HILB_I_coeffs, (float32_t *)&Fir_RX2_Hilbert_State_I[0], AUDIO_BUFFER_HALF_SIZE);
		arm_fir_init_f32(&FIR_RX2_Hilbert_Q, IQ_HILBERT_TAPS, (float32_t *)&FIR_HILB_Q_coeffs, (float32_t *)&Fir_RX2_Hilbert_State_Q[0], AUDIO_BUFFER_HALF_SIZE);
	}
	
	//LPF RX1
	uint32_t lpf1_width = 2700; //default settings
	if (CurrentVFO()->LPF_RX_Filter_Width > 0)
		lpf1_width = CurrentVFO()->LPF_RX_Filter_Width;
	IIR_BIQUAD_FILTER *lpf_filter = getIIRFilter(IIR_BIQUAD_LPF, lpf1_width);
	arm_biquad_cascade_df2T_initNoClean_f32(&IIR_RX1_LPF_I, lpf_filter->stages, (float32_t *)lpf_filter->coeffs, (float32_t *)&IIR_RX1_LPF_I_State[0]);
	arm_biquad_cascade_df2T_initNoClean_f32(&IIR_RX1_LPF_Q, lpf_filter->stages, (float32_t *)lpf_filter->coeffs, (float32_t *)&IIR_RX1_LPF_Q_State[0]);
	if (CurrentVFO()->LPF_TX_Filter_Width > 0)
		lpf1_width = CurrentVFO()->LPF_TX_Filter_Width;
	lpf_filter = getIIRFilter(IIR_BIQUAD_LPF, lpf1_width);
	arm_biquad_cascade_df2T_initNoClean_f32(&IIR_TX_LPF_I, lpf_filter->stages, (float32_t *)lpf_filter->coeffs, (float32_t *)&IIR_TX_LPF_I_State[0]);

	//RX1 GAUSS
	IIR_BIQUAD_FILTER *gauss_filter = getIIRFilter(IIR_BIQUAD_LPF_GAUSS, 1000);
	if (CurrentVFO()->Mode == TRX_MODE_CW_L || CurrentVFO()->Mode == TRX_MODE_CW_U)
		gauss_filter = getIIRFilter(IIR_BIQUAD_LPF_GAUSS, lpf1_width);
	arm_biquad_cascade_df2T_initNoClean_f32(&IIR_RX1_GAUSS, gauss_filter->stages, (float32_t *)gauss_filter->coeffs, (float32_t *)&IIR_RX1_GAUSS_State[0]);

	//LPF RX2
	uint32_t lpf2_width = 2700; //default settings
	if (SecondaryVFO()->LPF_RX_Filter_Width > 0)
		lpf2_width = SecondaryVFO()->LPF_RX_Filter_Width;
	IIR_BIQUAD_FILTER *lpf_filter2 = getIIRFilter(IIR_BIQUAD_LPF, lpf2_width);
	arm_biquad_cascade_df2T_initNoClean_f32(&IIR_RX2_LPF_I, lpf_filter2->stages, (float32_t *)lpf_filter2->coeffs, (float32_t *)&IIR_RX2_LPF_I_State[0]);
	arm_biquad_cascade_df2T_initNoClean_f32(&IIR_RX2_LPF_Q, lpf_filter2->stages, (float32_t *)lpf_filter2->coeffs, (float32_t *)&IIR_RX2_LPF_Q_State[0]);

	//RX2 GAUSS
	if (SecondaryVFO()->Mode == TRX_MODE_CW_L || SecondaryVFO()->Mode == TRX_MODE_CW_U)
		gauss_filter = getIIRFilter(IIR_BIQUAD_LPF_GAUSS, lpf2_width);
	arm_biquad_cascade_df2T_initNoClean_f32(&IIR_RX2_GAUSS, gauss_filter->stages, (float32_t *)gauss_filter->coeffs, (float32_t *)&IIR_RX2_GAUSS_State[0]);

	//HPF
	uint32_t hpf1_width = 300; //default settings
	if (CurrentVFO()->HPF_Filter_Width > 0)
		hpf1_width = CurrentVFO()->HPF_Filter_Width;
	IIR_BIQUAD_FILTER *hpf_filter = getIIRFilter(IIR_BIQUAD_HPF, hpf1_width);
	arm_biquad_cascade_df2T_initNoClean_f32(&IIR_RX1_HPF_I, hpf_filter->stages, (float32_t *)hpf_filter->coeffs, (float32_t *)&IIR_RX1_HPF_I_State[0]);
	arm_biquad_cascade_df2T_initNoClean_f32(&IIR_TX_HPF_I, hpf_filter->stages, (float32_t *)hpf_filter->coeffs, (float32_t *)&IIR_TX_HPF_I_State[0]);

	uint32_t hpf2_width = 300; //default settings
	if (SecondaryVFO()->HPF_Filter_Width > 0)
		hpf2_width = SecondaryVFO()->HPF_Filter_Width;
	IIR_BIQUAD_FILTER *hpf_filter2 = getIIRFilter(IIR_BIQUAD_HPF, hpf2_width);
	arm_biquad_cascade_df2T_initNoClean_f32(&IIR_RX2_HPF_I, hpf_filter2->stages, (float32_t *)hpf_filter2->coeffs, (float32_t *)&IIR_RX2_HPF_I_State[0]);

	//FM Squelch
	IIR_BIQUAD_FILTER *fm_sql_hpf_filter;
	if (CurrentVFO()->LPF_RX_Filter_Width > 15000 || CurrentVFO()->LPF_RX_Filter_Width == 0)
		fm_sql_hpf_filter = getIIRFilter(IIR_BIQUAD_HPF, 20000);
	else
		fm_sql_hpf_filter = getIIRFilter(IIR_BIQUAD_HPF, 15000);
	arm_biquad_cascade_df2T_initNoClean_f32(&IIR_RX1_Squelch_HPF, fm_sql_hpf_filter->stages, (float32_t *)fm_sql_hpf_filter->coeffs, (float32_t *)&IIR_RX1_HPF_SQL_State[0]);
	if (SecondaryVFO()->LPF_RX_Filter_Width > 15000 || SecondaryVFO()->LPF_RX_Filter_Width == 0)
		fm_sql_hpf_filter = getIIRFilter(IIR_BIQUAD_HPF, 20000);
	else
		fm_sql_hpf_filter = getIIRFilter(IIR_BIQUAD_HPF, 15000);
	arm_biquad_cascade_df2T_initNoClean_f32(&IIR_RX2_Squelch_HPF, fm_sql_hpf_filter->stages, (float32_t *)fm_sql_hpf_filter->coeffs, (float32_t *)&IIR_RX2_HPF_SQL_State[0]);

	//RX Equalizer
	calcBiquad(BIQUAD_peak, 400, TRX_SAMPLERATE, 0.5f, TRX.RX_EQ_LOW, EQ_RX_LOW_FILTER_Coeffs);
	calcBiquad(BIQUAD_peak, 1000, TRX_SAMPLERATE, 1.0f, TRX.RX_EQ_MID, EQ_RX_MID_FILTER_Coeffs);
	calcBiquad(BIQUAD_peak, 2000, TRX_SAMPLERATE, 1.5f, TRX.RX_EQ_HIG, EQ_RX_HIG_FILTER_Coeffs);

	//MIC Equalizer
	calcBiquad(BIQUAD_peak, 400, TRX_SAMPLERATE, 0.5f, TRX.MIC_EQ_LOW, EQ_MIC_LOW_FILTER_Coeffs);
	calcBiquad(BIQUAD_peak, 1000, TRX_SAMPLERATE, 1.0f, TRX.MIC_EQ_MID, EQ_MIC_MID_FILTER_Coeffs);
	calcBiquad(BIQUAD_peak, 2000, TRX_SAMPLERATE, 1.5f, TRX.MIC_EQ_HIG, EQ_MIC_HIG_FILTER_Coeffs);

	//All done
	NeedReinitAudioFilters = false;
	NeedReinitAudioFiltersClean = false;
}

// initialize the manual Notch filter
void InitNotchFilter(void)
{
	calcBiquad(BIQUAD_notch, CurrentVFO()->NotchFC / 2, TRX_SAMPLERATE, 0.5f, 0, NOTCH_RX1_Coeffs);
	calcBiquad(BIQUAD_notch, SecondaryVFO()->NotchFC / 2, TRX_SAMPLERATE, 0.5f, 0, NOTCH_RX2_Coeffs);
	NeedReinitNotch = false;
}

// start DC corrector
void dc_filter(float32_t *Buffer, int16_t blockSize, DC_FILTER_STATE stateNum) // removes the DC component of the signal
{
	static const float32_t A1 = (1.0f - 0.00048828125f); // (1-2^(-11))

	for (uint16_t i = 0; i < blockSize; i++)
	{
		float32_t sampleIn = Buffer[i];
		float32_t sampleOut = 0;
		float32_t delta_x = sampleIn - DC_Filter_State[stateNum].x_prev;
		float32_t a1_y_prev = A1 * DC_Filter_State[stateNum].y_prev;
		sampleOut = delta_x + a1_y_prev;
		DC_Filter_State[stateNum].x_prev = sampleIn;
		DC_Filter_State[stateNum].y_prev = sampleOut;
		Buffer[i] = sampleOut;
	}
}

// get filter from collection
static IIR_BIQUAD_FILTER *getIIRFilter(IIR_BIQUAD_FILTER_TYPE type, uint_fast16_t width)
{
	for (uint16_t i = 0; i < IIR_FILTERS_COUNT; i++)
		if (IIR_Biquad_Filters[i].type == type && IIR_Biquad_Filters[i].width == width)
			return (IIR_BIQUAD_FILTER *)&IIR_Biquad_Filters[i];
	println("Wrong filter length ", type, " ", (uint16_t)width);
	return (IIR_BIQUAD_FILTER *)&IIR_Biquad_Filters[0];
}

// automatic calculation of the Biquad filter
static void calcBiquad(BIQUAD_TYPE type, uint32_t Fc, uint32_t Fs, float32_t Q, float32_t peakGain, float32_t *outCoeffs)
{
	float32_t a0, a1, a2, b1, b2, norm;

	float32_t V = powf(10.0f, fabsf(peakGain) / 20.0f);
	float32_t K = tanf(PI * Fc / Fs);
	switch (type)
	{
	case BIQUAD_onepolelp:
		b1 = expf(-2.0f * PI * (Fc / Fs));
		a0 = 1.0f - b1;
		b1 = -b1;
		a1 = a2 = b2 = 0.0f;
		break;

	case BIQUAD_onepolehp:
		b1 = -expf(-2.0f * PI * (0.5f - Fc / Fs));
		a0 = 1.0f + b1;
		b1 = -b1;
		a1 = a2 = b2 = 0.0f;
		break;

	case BIQUAD_lowpass:
		norm = 1.0f / (1.0f + K / Q + K * K);
		a0 = K * K * norm;
		a1 = 2.0f * a0;
		a2 = a0;
		b1 = 2.0f * (K * K - 1.0f) * norm;
		b2 = (1.0f - K / Q + K * K) * norm;
		break;

	case BIQUAD_highpass:
		norm = 1.0f / (1.0f + K / Q + K * K);
		a0 = 1.0f * norm;
		a1 = -2.0f * a0;
		a2 = a0;
		b1 = 2.0f * (K * K - 1.0f) * norm;
		b2 = (1.0f - K / Q + K * K) * norm;
		break;

	case BIQUAD_bandpass:
		norm = 1.0f / (1.0f + K / Q + K * K);
		a0 = K / Q * norm;
		a1 = 0.0f;
		a2 = -a0;
		b1 = 2.0f * (K * K - 1.0f) * norm;
		b2 = (1.0f - K / Q + K * K) * norm;
		break;

	case BIQUAD_notch:
		norm = 1.0f / (1.0f + K / Q + K * K);
		a0 = (1.0f + K * K) * norm;
		a1 = 2.0f * (K * K - 1.0f) * norm;
		a2 = a0;
		b1 = a1;
		b2 = (1.0f - K / Q + K * K) * norm;
		break;

	case BIQUAD_peak:
		if (peakGain >= 0.0f)
		{
			norm = 1.0f / (1.0f + 1.0f / Q * K + K * K);
			a0 = (1.0f + V / Q * K + K * K) * norm;
			a1 = 2.0f * (K * K - 1.0f) * norm;
			a2 = (1.0f - V / Q * K + K * K) * norm;
			b1 = a1;
			b2 = (1.0f - 1.0f / Q * K + K * K) * norm;
		}
		else
		{
			norm = 1.0f / (1.0f + V / Q * K + K * K);
			a0 = (1.0f + 1.0f / Q * K + K * K) * norm;
			a1 = 2.0f * (K * K - 1.0f) * norm;
			a2 = (1.0f - 1.0f / Q * K + K * K) * norm;
			b1 = a1;
			b2 = (1.0f - V / Q * K + K * K) * norm;
		}
		break;
	case BIQUAD_lowShelf:
		if (peakGain >= 0.0f)
		{
			norm = 1.0f / (1.0f + SQRT2 * K + K * K);
			a0 = (1.0f + sqrtf(2.0f * V) * K + V * K * K) * norm;
			a1 = 2.0f * (V * K * K - 1.0f) * norm;
			a2 = (1.0f - sqrtf(2.0f * V) * K + V * K * K) * norm;
			b1 = 2.0f * (K * K - 1.0f) * norm;
			b2 = (1.0f - SQRT2 * K + K * K) * norm;
		}
		else
		{
			norm = 1.0f / (1.0f + sqrtf(2.0f * V) * K + V * K * K);
			a0 = (1.0f + SQRT2 * K + K * K) * norm;
			a1 = 2.0f * (K * K - 1.0f) * norm;
			a2 = (1.0f - SQRT2 * K + K * K) * norm;
			b1 = 2.0f * (V * K * K - 1.0f) * norm;
			b2 = (1.0f - sqrtf(2.0f * V) * K + V * K * K) * norm;
		}
		break;
	case BIQUAD_highShelf:
		if (peakGain >= 0.0f)
		{
			norm = 1.0f / (1.0f + SQRT2 * K + K * K);
			a0 = (V + sqrtf(2.0f * V) * K + K * K) * norm;
			a1 = 2.0f * (K * K - V) * norm;
			a2 = (V - sqrtf(2.0f * V) * K + K * K) * norm;
			b1 = 2.0f * (K * K - 1.0f) * norm;
			b2 = (1.0f - SQRT2 * K + K * K) * norm;
		}
		else
		{
			norm = 1.0f / (V + sqrtf(2.0f * V) * K + K * K);
			a0 = (1.0f + SQRT2 * K + K * K) * norm;
			a1 = 2.0f * (K * K - 1.0f) * norm;
			a2 = (1.0f - SQRT2 * K + K * K) * norm;
			b1 = 2.0f * (K * K - V) * norm;
			b2 = (V - sqrtf(2.0f * V) * K + K * K) * norm;
		}
		break;
	}

	//save coefficients
	outCoeffs[0] = a0;
	outCoeffs[1] = a1;
	outCoeffs[2] = a2;
	outCoeffs[3] = -b1;
	outCoeffs[4] = -b2;
}

static void arm_biquad_cascade_df2T_initNoClean_f32(arm_biquad_cascade_df2T_instance_f32 *S, uint8_t numStages, const float32_t *pCoeffs, float32_t *pState)
{
	if (NeedReinitAudioFiltersClean) //original func
	{
		arm_biquad_cascade_df2T_init_f32(S, numStages, pCoeffs, pState);
		return;
	}

	/* Assign filter stages */
	S->numStages = numStages;

	/* Assign coefficient pointer */
	S->pCoeffs = pCoeffs;

	/* Assign state pointer */
	S->pState = pState;
}
